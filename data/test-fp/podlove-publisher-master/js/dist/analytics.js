!function(){function t(t,e){"use strict";var n={version:"2.0.0-beta.4",constants:{CHART_CLASS:"dc-chart",DEBUG_GROUP_CLASS:"debug",STACK_CLASS:"stack",DESELECTED_CLASS:"deselected",SELECTED_CLASS:"selected",NODE_INDEX_NAME:"__index__",GROUP_INDEX_NAME:"__group_index__",DEFAULT_CHART_GROUP:"__default_chart_group__",EVENT_DELAY:40,NEGLIGIBLE_NUMBER:1e-10},_renderlet:null};n.chartRegistry=function(){function t(t){return t||(t=n.constants.DEFAULT_CHART_GROUP),e[t]||(e[t]=[]),t}var e={};return{has:function(t){for(var n in e)if(e[n].indexOf(t)>=0)return!0;return!1},register:function(n,r){r=t(r),e[r].push(n)},deregister:function(n,r){r=t(r);for(var i=0;i<e[r].length;i++)if(e[r][i].anchorName()===n.anchorName()){e[r].splice(i,1);break}},clear:function(t){t?delete e[t]:e={}},list:function(n){return n=t(n),e[n]}}}(),n.registerChart=function(t,e){n.chartRegistry.register(t,e)},n.deregisterChart=function(t,e){n.chartRegistry.deregister(t,e)},n.hasChart=function(t){return n.chartRegistry.has(t)},n.deregisterAllCharts=function(t){n.chartRegistry.clear(t)},n.filterAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].filterAll()},n.refocusAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].focus&&e[r].focus()},n.renderAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].render();null!==n._renderlet&&n._renderlet(t)},n.redrawAll=function(t){for(var e=n.chartRegistry.list(t),r=0;r<e.length;++r)e[r].redraw();null!==n._renderlet&&n._renderlet(t)},n.disableTransitions=!1,n.transition=function(t,e,r){if(e<=0||void 0===e||n.disableTransitions)return t;var i=t.transition().duration(e);return"function"==typeof r&&r(i),i},n.units={},n.units.integers=function(t,e){return Math.abs(e-t)},n.units.ordinal=function(t,e,n){return n},n.units.fp={},n.units.fp.precision=function(t){var e=function(t,r){var i=Math.abs((r-t)/e.resolution);return n.utils.isNegligible(i-Math.floor(i))?Math.floor(i):Math.ceil(i)};return e.resolution=t,e},n.round={},n.round.floor=function(t){return Math.floor(t)},n.round.ceil=function(t){return Math.ceil(t)},n.round.round=function(t){return Math.round(t)},n.override=function(t,e,n){var r=t[e];t["_"+e]=r,t[e]=n},n.renderlet=function(t){return arguments.length?(n._renderlet=t,n):n._renderlet},n.instanceOfChart=function(t){return t instanceof Object&&t.__dcFlag__&&!0},n.errors={},n.errors.Exception=function(t){var e=t||"Unexpected internal error";this.message=e,this.toString=function(){return e}},n.errors.InvalidStateException=function(){n.errors.Exception.apply(this,arguments)},n.dateFormat=t.time.format("%m/%d/%Y"),n.printers={},n.printers.filters=function(t){for(var e="",r=0;r<t.length;++r)r>0&&(e+=", "),e+=n.printers.filter(t[r]);return e},n.printers.filter=function(t){var e="";return void 0!==t&&null!==t&&(t instanceof Array?t.length>=2?e="["+n.utils.printSingleValue(t[0])+" -> "+n.utils.printSingleValue(t[1])+"]":t.length>=1&&(e=n.utils.printSingleValue(t[0])):e=n.utils.printSingleValue(t)),e},n.pluck=function(t,e){return e?function(n,r){return e.call(n,n[t],r)}:function(e){return e[t]}},n.utils={},n.utils.printSingleValue=function(t){var e=""+t;return t instanceof Date?e=n.dateFormat(t):"string"==typeof t?e=t:n.utils.isFloat(t)?e=n.utils.printSingleValue.fformat(t):n.utils.isInteger(t)&&(e=Math.round(t)),e},n.utils.printSingleValue.fformat=t.format(".2f"),n.utils.add=function(t,e){if("string"==typeof e&&(e=e.replace("%","")),t instanceof Date){"string"==typeof e&&(e=+e);var n=new Date;return n.setTime(t.getTime()),n.setDate(t.getDate()+e),n}if("string"==typeof e){var r=+e/100;return t>0?t*(1+r):t*(1-r)}return t+e},n.utils.subtract=function(t,e){if("string"==typeof e&&(e=e.replace("%","")),t instanceof Date){"string"==typeof e&&(e=+e);var n=new Date;return n.setTime(t.getTime()),n.setDate(t.getDate()-e),n}if("string"==typeof e){var r=+e/100;return t<0?t*(1+r):t*(1-r)}return t-e},n.utils.isNumber=function(t){return t===+t},n.utils.isFloat=function(t){return t===+t&&t!==(0|t)},n.utils.isInteger=function(t){return t===+t&&t===(0|t)},n.utils.isNegligible=function(t){return!n.utils.isNumber(t)||t<n.constants.NEGLIGIBLE_NUMBER&&t>-n.constants.NEGLIGIBLE_NUMBER},n.utils.clamp=function(t,e,n){return t<e?e:t>n?n:t};var r=0;return n.utils.uniqueId=function(){return++r},n.utils.nameToId=function(t){return t.toLowerCase().replace(/[\s]/g,"_").replace(/[\.']/g,"")},n.utils.appendOrSelect=function(t,e,n){n=n||e;var r=t.select(e);return r.empty()&&(r=t.append(n)),r},n.utils.safeNumber=function(t){return n.utils.isNumber(+t)?+t:0},n.logger={},n.logger.enableDebugLog=!1,n.logger.warn=function(t){return console&&(console.warn?console.warn(t):console.log&&console.log(t)),n.logger},n.logger.debug=function(t){return n.logger.enableDebugLog&&console&&(console.debug?console.debug(t):console.log&&console.log(t)),n.logger},n.logger.deprecate=function(t,e){function r(){return i||(n.logger.warn(e),i=!0),t.apply(this,arguments)}var i=!1;return r},n.events={current:null},n.events.trigger=function(t,e){if(!e)return void t();n.events.current=t,setTimeout(function(){t===n.events.current&&t()},e)},n.filters={},n.filters.RangedFilter=function(t,e){var n=new Array(t,e);return n.isFiltered=function(t){return t>=this[0]&&t<this[1]},n},n.filters.TwoDimensionalFilter=function(t){if(null===t)return null;var e=t;return e.isFiltered=function(t){return t.length&&t.length===e.length&&t[0]===e[0]&&t[1]===e[1]},e},n.filters.RangedTwoDimensionalFilter=function(t){if(null===t)return null;var e,n=t;return e=n[0]instanceof Array?[[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1])],[Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])]]:[[t[0],-(1/0)],[t[1],1/0]],n.isFiltered=function(t){var n,r;if(t instanceof Array){if(2!==t.length)return!1;n=t[0],r=t[1]}else n=t,r=e[0][1];return n>=e[0][0]&&n<e[1][0]&&r>=e[0][1]&&r<e[1][1]},n},n.baseMixin=function(r){function i(){return d=r.root().append("svg").attr("width",r.width()).attr("height",r.height())}function a(t){if(!r[t]||!r[t]())throw new n.errors.InvalidStateException("Mandatory attribute chart."+t+" is missing on chart[#"+r.anchorName()+"]")}function o(){if(r.dimension()&&r.dimension().filter){var t=F(r.dimension(),M);M=t?t:M}}r.__dcFlag__=n.utils.uniqueId();var u,l,s,c,d,f,h,g=200,p=function(t){var e=t&&t.getBoundingClientRect&&t.getBoundingClientRect().width;return e&&e>g?e:g},m=p,x=200,v=function(t){var e=t&&t.getBoundingClientRect&&t.getBoundingClientRect().height;return e&&e>x?e:x},y=v,A=n.pluck("key"),b=n.pluck("value"),_=n.pluck("key"),k=n.pluck("key"),w=!1,D=function(t){return r.keyAccessor()(t)+": "+r.valueAccessor()(t)},C=!0,L=750,E=n.printers.filters,R=["dimension","group"],S=n.constants.DEFAULT_CHART_GROUP,O=t.dispatch("preRender","postRender","preRedraw","postRedraw","filtered","zoomed","renderlet"),M=[],F=function(t,e){return t.filter(null),0===e.length?t.filter(null):t.filterFunction(function(t){for(var n=0;n<e.length;n++){var r=e[n];if(r.isFiltered&&r.isFiltered(t))return!0;if(r<=t&&r>=t)return!0}return!1}),e},B=function(t){return t.all()};r.width=function(e){return arguments.length?(m=t.functor(e||p),r):m(c.node())},r.height=function(e){return arguments.length?(y=t.functor(e||v),r):y(c.node())},r.minWidth=function(t){return arguments.length?(g=t,r):g},r.minHeight=function(t){return arguments.length?(x=t,r):x},r.dimension=function(t){return arguments.length?(u=t,r.expireCache(),r):u},r.data=function(e){return arguments.length?(B=t.functor(e),r.expireCache(),r):B.call(r,l)},r.group=function(t,e){return arguments.length?(l=t,r._groupName=e,r.expireCache(),r):l},r.ordering=function(t){return arguments.length?(k=t,f=e.quicksort.by(k),r.expireCache(),r):k},r._computeOrderedGroups=function(t){var n=t.slice(0);return n.length<=1?n:(f||(f=e.quicksort.by(k)),f(n,0,n.length))},r.filterAll=function(){return r.filter(null)},r.select=function(t){return c.select(t)},r.selectAll=function(t){return c?c.selectAll(t):null},r.anchor=function(e,i){return arguments.length?(n.instanceOfChart(e)?(s=e.anchor(),c=e.root()):(s=e,c=t.select(s),c.classed(n.constants.CHART_CLASS,!0),n.registerChart(r,i)),S=i,r):s},r.anchorName=function(){var t=r.anchor();return t&&t.id?t.id:t&&t.replace?t.replace("#",""):"dc-chart"+r.chartID()},r.root=function(t){return arguments.length?(c=t,r):c},r.svg=function(t){return arguments.length?(d=t,r):d},r.resetSvg=function(){return r.select("svg").remove(),i()},r.filterPrinter=function(t){return arguments.length?(E=t,r):E},r.turnOnControls=function(){return c&&(r.selectAll(".reset").style("display",null),r.selectAll(".filter").text(E(r.filters())).style("display",null)),r},r.turnOffControls=function(){return c&&(r.selectAll(".reset").style("display","none"),r.selectAll(".filter").style("display","none").text(r.filter())),r},r.transitionDuration=function(t){return arguments.length?(L=t,r):L},r._mandatoryAttributes=function(t){return arguments.length?(R=t,r):R},r.render=function(){O.preRender(r),R&&R.forEach(a);var t=r._doRender();return h&&h.render(),r._activateRenderlets("postRender"),t},r._activateRenderlets=function(t){r.transitionDuration()>0&&d?d.transition().duration(r.transitionDuration()).each("end",function(){O.renderlet(r),t&&O[t](r)}):(O.renderlet(r),t&&O[t](r))},r.redraw=function(){O.preRedraw(r);var t=r._doRedraw();return h&&h.render(),r._activateRenderlets("postRedraw"),t},r.redrawGroup=function(){n.redrawAll(r.chartGroup())},r.renderGroup=function(){n.renderAll(r.chartGroup())},r._invokeFilteredListener=function(t){void 0!==t&&O.filtered(r,t)},r._invokeZoomedListener=function(){O.zoomed(r)};var T=function(t,e){return null===e||void 0===e?t.length>0:t.some(function(t){return e<=t&&e>=t})};r.hasFilterHandler=function(t){return arguments.length?(T=t,r):T},r.hasFilter=function(t){return T(M,t)};var N=function(t,e){for(var n=0;n<t.length;n++)if(t[n]<=e&&t[n]>=e){t.splice(n,1);break}return t};r.removeFilterHandler=function(t){return arguments.length?(N=t,r):N};var P=function(t,e){return t.push(e),t};r.addFilterHandler=function(t){return arguments.length?(P=t,r):P};var H=function(t){return[]};return r.resetFilterHandler=function(t){return arguments.length?(H=t,r):H},r.replaceFilter=function(t){M=[],r.filter(t)},r.filter=function(t){return arguments.length?(t instanceof Array&&t[0]instanceof Array&&!t.isFiltered?t[0].forEach(function(t){r.hasFilter(t)?N(M,t):P(M,t)}):null===t?M=H(M):r.hasFilter(t)?N(M,t):P(M,t),o(),r._invokeFilteredListener(t),null!==c&&r.hasFilter()?r.turnOnControls():r.turnOffControls(),r):M.length>0?M[0]:null},r.filters=function(){return M},r.highlightSelected=function(e){t.select(e).classed(n.constants.SELECTED_CLASS,!0),t.select(e).classed(n.constants.DESELECTED_CLASS,!1)},r.fadeDeselected=function(e){t.select(e).classed(n.constants.SELECTED_CLASS,!1),t.select(e).classed(n.constants.DESELECTED_CLASS,!0)},r.resetHighlight=function(e){t.select(e).classed(n.constants.SELECTED_CLASS,!1),t.select(e).classed(n.constants.DESELECTED_CLASS,!1)},r.onClick=function(t){var e=r.keyAccessor()(t);n.events.trigger(function(){r.filter(e),r.redrawGroup()})},r.filterHandler=function(t){return arguments.length?(F=t,r):F},r._doRender=function(){return r},r._doRedraw=function(){return r},r.legendables=function(){return[]},r.legendHighlight=function(){},r.legendReset=function(){},r.legendToggle=function(){},r.isLegendableHidden=function(){return!1},r.keyAccessor=function(t){return arguments.length?(A=t,r):A},r.valueAccessor=function(t){return arguments.length?(b=t,r):b},r.label=function(t){return arguments.length?(_=t,w=!0,r):_},r.renderLabel=function(t){return arguments.length?(w=t,r):w},r.title=function(t){return arguments.length?(D=t,r):D},r.renderTitle=function(t){return arguments.length?(C=t,r):C},r.renderlet=n.logger.deprecate(function(t){return r.on("renderlet."+n.utils.uniqueId(),t),r},'chart.renderlet has been deprecated.  Please use chart.on("renderlet.<renderletKey>", renderletFunction)'),r.chartGroup=function(t){return arguments.length?(S=t,r):S},r.expireCache=function(){return r},r.legend=function(t){return arguments.length?(h=t,h.parent(r),r):h},r.chartID=function(){return r.__dcFlag__},r.options=function(t){for(var e in t)"function"==typeof r[e]?r[e].call(r,t[e]):n.logger.debug("Not a valid option setter name: "+e);return r},r.on=function(t,e){return O.on(t,e),r},r},n.marginMixin=function(t){var e={top:10,right:50,bottom:30,left:30};return t.margins=function(n){return arguments.length?(e=n,t):e},t.effectiveWidth=function(){return t.width()-t.margins().left-t.margins().right},t.effectiveHeight=function(){return t.height()-t.margins().top-t.margins().bottom},t},n.colorMixin=function(e){var n=t.scale.category20c(),r=!0,i=function(t){return e.keyAccessor()(t)};return e.colors=function(r){return arguments.length?(n=r instanceof Array?t.scale.quantize().range(r):t.functor(r),e):n},e.ordinalColors=function(n){return e.colors(t.scale.ordinal().range(n))},e.linearColors=function(n){return e.colors(t.scale.linear().range(n).interpolate(t.interpolateHcl))},e.colorAccessor=function(t){return arguments.length?(i=t,r=!1,e):i},e.defaultColorAccessor=function(){return r},e.colorDomain=function(t){return arguments.length?(n.domain(t),e):n.domain()},e.calculateColorDomain=function(){var r=[t.min(e.data(),e.colorAccessor()),t.max(e.data(),e.colorAccessor())];return n.domain(r),e},e.getColor=function(t,e){return n(i.call(this,t,e))},e.colorCalculator=function(t){return arguments.length?(e.getColor=t,e):e.getColor},e},n.coordinateGridMixin=function(e){function r(){U=!0,I&&(e.x().domain(d(e.x().domain(),A)),L&&e.x().domain(d(e.x().domain(),L.x().domain())));var t=e.x().domain(),r=n.filters.RangedFilter(t[0],t[1]);e.replaceFilter(r),e.rescale(),e.redraw(),L&&!f(e.filter(),L.filter())&&n.events.trigger(function(){L.replaceFilter(r),L.redraw()}),e._invokeZoomedListener(),n.events.trigger(function(){e.redrawGroup()},n.constants.EVENT_DELAY),U=!f(t,A)}function i(t){e.isOrdinal()?(e.elasticX()||0===y.domain().length)&&y.domain(e._ordinalXDomain()):e.elasticX()&&y.domain([e.xAxisMin(),e.xAxisMax()]);var n=y.domain();_&&!n.some(function(t,e){return t!==_[e]})||e.rescale(),_=n,e.isOrdinal()?y.rangeBands([0,e.xAxisLength()],Q,e._useOuterPadding()?Z:0):y.range([0,e.xAxisLength()]),R=R.scale(e.x()),a(t)}function a(t){var r=t.selectAll("g."+p);if(V){r.empty()&&(r=t.insert("g",":first-child").attr("class",g+" "+p).attr("transform","translate("+e.margins().left+","+e.margins().top+")"));var i=R.tickValues()?R.tickValues():"function"==typeof y.ticks?y.ticks(R.ticks()[0]):y.domain(),a=r.selectAll("line").data(i),o=a.enter().append("line").attr("x1",function(t){return y(t)}).attr("y1",e._xAxisY()-e.margins().top).attr("x2",function(t){return y(t)}).attr("y2",0).attr("opacity",0);n.transition(o,e.transitionDuration()).attr("opacity",1),n.transition(a,e.transitionDuration()).attr("x1",function(t){return y(t)}).attr("y1",e._xAxisY()-e.margins().top).attr("x2",function(t){return y(t)}).attr("y2",0),a.exit().remove()}else r.selectAll("line").remove()}function o(){return e._xAxisY()-e.margins().top}function u(){return e.anchorName().replace(/[ .#]/g,"-")+"-clip"}function l(){var t=n.utils.appendOrSelect(m,"defs"),r=u(),i=n.utils.appendOrSelect(t,"#"+r,"clipPath").attr("id",r),a=2*K;n.utils.appendOrSelect(i,"rect").attr("width",e.xAxisLength()+a).attr("height",e.yAxisHeight()+a).attr("transform","translate(-"+K+", -"+K+")")}function s(t){e.isOrdinal()&&(G=!1),i(e.g()),e._prepareYAxis(e.g()),e.plotData(),(e.elasticX()||U||t)&&e.renderXAxis(e.g()),(e.elasticY()||t)&&e.renderYAxis(e.g()),t?e.renderBrush(e.g()):e.redrawBrush(e.g())}function c(){W?e._enableMouseZoom():q&&e._disableMouseZoom()}function d(e,n){var r=[];return r[0]=t.max([e[0],n[0]]),r[1]=t.min([e[1],n[1]]),r}function f(t,e){return!t&&!e||!(!t||!e)&&(0===t.length&&0===e.length||t[0].valueOf()===e[0].valueOf()&&t[1].valueOf()===e[1].valueOf())}function h(t){return t instanceof Array&&t.length>1}var g="grid-line",p="vertical";e=n.colorMixin(n.marginMixin(n.baseMixin(e))),e.colors(t.scale.category10()),e._mandatoryAttributes().push("x");var m,x,v,y,A,b,_,k,w,D,C,L,E,R=t.svg.axis().orient("bottom"),S=n.units.integers,O=0,M=!1,F=0,B=t.svg.axis().orient("left"),T=0,N=!1,P=0,H=t.svg.brush(),G=!0,Y=!1,V=!1,U=!1,z=[1,1/0],I=!0,X=t.behavior.zoom().on("zoom",r),j=t.behavior.zoom().on("zoom",null),q=!1,W=!1,K=0,Z=.5,Q=0,J=!1;return e.rescale=function(){C=void 0},e.rangeChart=function(t){return arguments.length?(L=t,L.focusChart(e),e):L},e.zoomScale=function(t){return arguments.length?(z=t,e):z},e.zoomOutRestrict=function(t){return arguments.length?(z[0]=t?1:0,I=t,e):I},e._generateG=function(t){return m=void 0===t?e.svg():t,x=m.append("g"),v=x.append("g").attr("class","chart-body").attr("transform","translate("+e.margins().left+", "+e.margins().top+")").attr("clip-path","url(#"+u()+")"),x},e.g=function(t){return arguments.length?(x=t,e):x},e.mouseZoomable=function(t){return arguments.length?(W=t,e):W},e.chartBodyG=function(t){return arguments.length?(v=t,e):v},e.x=function(t){return arguments.length?(y=t,A=y.domain(),e):y},e.xOriginalDomain=function(){return A},e.xUnits=function(t){return arguments.length?(S=t,e):S},e.xAxis=function(t){return arguments.length?(R=t,e):R},e.elasticX=function(t){return arguments.length?(M=t,e):M},e.xAxisPadding=function(t){return arguments.length?(O=t,e):O},e.xUnitCount=function(){if(void 0===C){var t=e.xUnits()(e.x().domain()[0],e.x().domain()[1],e.x().domain());C=t instanceof Array?t.length:t}return C},e.useRightYAxis=function(t){return arguments.length?(J=t,e):J},e.isOrdinal=function(){return e.xUnits()===n.units.ordinal},e._useOuterPadding=function(){return!0},e._ordinalXDomain=function(){return e._computeOrderedGroups(e.data()).map(e.keyAccessor())},e.renderXAxis=function(t){var r=t.selectAll("g.x");r.empty()&&(r=t.append("g").attr("class","axis x").attr("transform","translate("+e.margins().left+","+e._xAxisY()+")"));var i=t.selectAll("text.x-axis-label");i.empty()&&e.xAxisLabel()&&(i=t.append("text").attr("transform","translate("+(e.margins().left+e.xAxisLength()/2)+","+(e.height()-F)+")").attr("class","x-axis-label").attr("text-anchor","middle").text(e.xAxisLabel())),e.xAxisLabel()&&i.text()!==e.xAxisLabel()&&i.text(e.xAxisLabel()),n.transition(r,e.transitionDuration()).call(R)},e._xAxisY=function(){return e.height()-e.margins().bottom},e.xAxisLength=function(){return e.effectiveWidth()},e.xAxisLabel=function(t,n){return arguments.length?(b=t,e.margins().bottom-=F,F=void 0===n?12:n,e.margins().bottom+=F,e):b},e._prepareYAxis=function(n){if(void 0===k||e.elasticY()){k=t.scale.linear();var r=e.yAxisMin()||0,i=e.yAxisMax()||0;k.domain([r,i]).rangeRound([e.yAxisHeight(),0])}k.range([e.yAxisHeight(),0]),B=B.scale(k),J&&B.orient("right"),e._renderHorizontalGridLinesForAxis(n,k,B)},e.renderYAxisLabel=function(t,n,r,i){i=i||P;var a=e.g().selectAll("text.y-axis-label."+t+"-label");if(a.empty()&&n){var o=e.margins().top+e.yAxisHeight()/2;a=e.g().append("text").attr("transform","translate("+i+","+o+"),rotate("+r+")").attr("class","y-axis-label "+t+"-label").attr("text-anchor","middle").text(n)}n&&a.text()!==n&&a.text(n)},e.renderYAxisAt=function(t,r,i){var a=e.g().selectAll("g."+t);a.empty()&&(a=e.g().append("g").attr("class","axis "+t).attr("transform","translate("+i+","+e.margins().top+")")),n.transition(a,e.transitionDuration()).call(r)},e.renderYAxis=function(){var t=J?e.width()-e.margins().right:e._yAxisX();e.renderYAxisAt("y",B,t);var n=J?e.width()-P:P,r=J?90:-90;e.renderYAxisLabel("y",e.yAxisLabel(),r,n)},e._renderHorizontalGridLinesForAxis=function(t,r,i){var a=t.selectAll("g.horizontal");if(Y){var o=i.tickValues()?i.tickValues():r.ticks(i.ticks()[0]);a.empty()&&(a=t.insert("g",":first-child").attr("class",g+" horizontal").attr("transform","translate("+e.margins().left+","+e.margins().top+")"));var u=a.selectAll("line").data(o),l=u.enter().append("line").attr("x1",1).attr("y1",function(t){return r(t)}).attr("x2",e.xAxisLength()).attr("y2",function(t){return r(t)}).attr("opacity",0);n.transition(l,e.transitionDuration()).attr("opacity",1),n.transition(u,e.transitionDuration()).attr("x1",1).attr("y1",function(t){return r(t)}).attr("x2",e.xAxisLength()).attr("y2",function(t){return r(t)}),u.exit().remove()}else a.selectAll("line").remove()},e._yAxisX=function(){return e.useRightYAxis()?e.width()-e.margins().right:e.margins().left},e.yAxisLabel=function(t,n){return arguments.length?(w=t,e.margins().left-=P,P=void 0===n?12:n,e.margins().left+=P,e):w},e.y=function(t){return arguments.length?(k=t,e):k},e.yAxis=function(t){return arguments.length?(B=t,e):B},e.elasticY=function(t){return arguments.length?(N=t,e):N},e.renderHorizontalGridLines=function(t){return arguments.length?(Y=t,e):Y},e.renderVerticalGridLines=function(t){return arguments.length?(V=t,e):V},e.xAxisMin=function(){var r=t.min(e.data(),function(t){return e.keyAccessor()(t)});return n.utils.subtract(r,O)},e.xAxisMax=function(){var r=t.max(e.data(),function(t){return e.keyAccessor()(t)});return n.utils.add(r,O)},e.yAxisMin=function(){var r=t.min(e.data(),function(t){return e.valueAccessor()(t)});return n.utils.subtract(r,T)},e.yAxisMax=function(){var r=t.max(e.data(),function(t){return e.valueAccessor()(t)});return n.utils.add(r,T)},e.yAxisPadding=function(t){return arguments.length?(T=t,e):T},e.yAxisHeight=function(){return e.effectiveHeight()},e.round=function(t){return arguments.length?(D=t,e):D},e._rangeBandPadding=function(t){return arguments.length?(Q=t,e):Q},e._outerRangeBandPadding=function(t){return arguments.length?(Z=t,e):Z},n.override(e,"filter",function(t){return arguments.length?(e._filter(t),t?e.brush().extent(t):e.brush().clear(),e):e._filter()}),e.brush=function(t){return arguments.length?(H=t,e):H},e.renderBrush=function(t){if(G){H.on("brush",e._brushing),H.on("brushstart",e._disableMouseZoom),H.on("brushend",c);var n=t.append("g").attr("class","brush").attr("transform","translate("+e.margins().left+","+e.margins().top+")").call(H.x(e.x()));e.setBrushY(n),e.setHandlePaths(n),e.hasFilter()&&e.redrawBrush(t)}},e.setHandlePaths=function(t){t.selectAll(".resize").append("path").attr("d",e.resizeHandlePath)},e.setBrushY=function(t){t.selectAll("rect").attr("height",o())},e.extendBrush=function(){var t=H.extent();return e.round()&&(t[0]=t.map(e.round())[0],t[1]=t.map(e.round())[1],x.select(".brush").call(H.extent(t))),t},e.brushIsEmpty=function(t){return H.empty()||!t||t[1]<=t[0]},e._brushing=function(){var t=e.extendBrush();if(e.redrawBrush(x),e.brushIsEmpty(t))n.events.trigger(function(){e.filter(null),e.redrawGroup()},n.constants.EVENT_DELAY);else{var r=n.filters.RangedFilter(t[0],t[1]);n.events.trigger(function(){e.replaceFilter(r),e.redrawGroup()},n.constants.EVENT_DELAY)}},e.redrawBrush=function(t){if(G){e.filter()&&e.brush().empty()&&e.brush().extent(e.filter());var n=t.select("g.brush");n.call(e.brush().x(e.x())),e.setBrushY(n)}e.fadeDeselectedArea()},e.fadeDeselectedArea=function(){},e.resizeHandlePath=function(t){var e=+("e"===t),n=e?1:-1,r=o()/3;return"M"+.5*n+","+r+"A6,6 0 0 "+e+" "+6.5*n+","+(r+6)+"V"+(2*r-6)+"A6,6 0 0 "+e+" "+.5*n+","+2*r+"ZM"+2.5*n+","+(r+8)+"V"+(2*r-8)+"M"+4.5*n+","+(r+8)+"V"+(2*r-8)},e.clipPadding=function(t){return arguments.length?(K=t,e):K},e._preprocessData=function(){},e._doRender=function(){return e.resetSvg(),e._preprocessData(),e._generateG(),l(),s(!0),c(),e},e._doRedraw=function(){return e._preprocessData(),s(!1),l(),e},e._enableMouseZoom=function(){q=!0,X.x(e.x()).scaleExtent(z).size([e.width(),e.height()]).duration(e.transitionDuration()),e.root().call(X)},e._disableMouseZoom=function(){e.root().call(j)},e.focus=function(t){h(t)?e.x().domain(t):e.x().domain(A),X.x(e.x()),r()},e.refocused=function(){return U},e.focusChart=function(t){return arguments.length?(E=t,e.on("filtered",function(t){t.filter()?f(t.filter(),E.filter())||n.events.trigger(function(){E.focus(t.filter())}):n.events.trigger(function(){E.x().domain(E.xOriginalDomain())})}),e):E},e.brushOn=function(t){return arguments.length?(G=t,e):G},e},n.stackMixin=function(e){function r(t,n){var r=t.accessor||e.valueAccessor();return t.name=String(t.name||n),t.values=t.group.all().map(function(n,i){return{x:e.keyAccessor()(n,i),y:t.hidden?null:r(n,i),data:n,layer:t.name,hidden:t.hidden}}),t.values=t.values.filter(i()),t.values}function i(){if(!e.x())return t.functor(!0);var n=e.x().domain();return e.isOrdinal()?function(){return!0}:e.elasticX()?function(){return!0}:function(t){return t.x>=n[0]&&t.x<=n[n.length-1]}}function a(t){return s[s.map(n.pluck("name")).indexOf(t)]}function o(){return e.data().reduce(function(t,e){return t.concat(e.values)},[])}function u(t){return!t.hidden}var l=t.layout.stack().values(r),s=[],c={},d=!1;return e.stack=function(t,n,r){if(!arguments.length)return s;arguments.length<=2&&(r=n);var i={group:t};return"string"==typeof n&&(i.name=n),"function"==typeof r&&(i.accessor=r),s.push(i),e},n.override(e,"group",function(t,n,r){return arguments.length?(s=[],c={},e.stack(t,n),r&&e.valueAccessor(r),e._group(t,n)):e._group()}),e.hidableStacks=function(t){return arguments.length?(d=t,e):d},e.hideStack=function(t){var n=a(t);return n&&(n.hidden=!0),e},e.showStack=function(t){var n=a(t);return n&&(n.hidden=!1),e},e.getValueAccessorByIndex=function(t){return s[t].accessor||e.valueAccessor()},e.yAxisMin=function(){var r=t.min(o(),function(t){return t.y+t.y0<t.y0?t.y+t.y0:t.y0});return n.utils.subtract(r,e.yAxisPadding())},e.yAxisMax=function(){var r=t.max(o(),function(t){return t.y+t.y0});return n.utils.add(r,e.yAxisPadding())},e.xAxisMin=function(){var r=t.min(o(),n.pluck("x"));return n.utils.subtract(r,e.xAxisPadding())},e.xAxisMax=function(){var r=t.max(o(),n.pluck("x"));return n.utils.add(r,e.xAxisPadding())},n.override(e,"title",function(t,n){return t?"function"==typeof t?e._title(t):t===e._groupName&&"function"==typeof n?e._title(n):"function"!=typeof n?c[t]||e._title():(c[t]=n,e):e._title()}),e.stackLayout=function(t){return arguments.length?(l=t,e):l},e.data(function(){var t=s.filter(u);return t.length?e.stackLayout()(t):[]}),e._ordinalXDomain=function(){return o().map(n.pluck("x"))},e.colorAccessor(function(t){return this.layer||this.name||t.name||t.layer}),e.legendables=function(){return s.map(function(t,n){return{chart:e,name:t.name,hidden:t.hidden||!1,color:e.getColor.call(t,t.values,n)}})},e.isLegendableHidden=function(t){var e=a(t.name);return!!e&&e.hidden},e.legendToggle=function(t){d&&(e.isLegendableHidden(t)?e.showStack(t.name):e.hideStack(t.name),e.renderGroup())},e},n.capMixin=function(e){var r=1/0,i="Others",a=function(n){var r=t.sum(n,e.valueAccessor()),a=e.group().all(),o=t.sum(a,e.valueAccessor()),u=n.map(e.keyAccessor()),l=a.map(e.keyAccessor()),s=t.set(u),c=l.filter(function(t){return!s.has(t)});return o>r?n.concat([{others:c,key:i,value:o-r}]):n};return e.cappedKeyAccessor=function(t,n){return t.others?t.key:e.keyAccessor()(t,n)},e.cappedValueAccessor=function(t,n){return t.others?t.value:e.valueAccessor()(t,n)},e.data(function(t){if(r===1/0)return e._computeOrderedGroups(t.all());var n=t.top(r);return n=e._computeOrderedGroups(n),a?a(n):n}),e.cap=function(t){return arguments.length?(r=t,e):r},e.othersLabel=function(t){return arguments.length?(i=t,e):i},e.othersGrouper=function(t){return arguments.length?(a=t,e):a},n.override(e,"onClick",function(t){t.others&&e.filter([t.others]),e._onClick(t)}),e},n.bubbleMixin=function(e){var r=.3,i=10;e.BUBBLE_NODE_CLASS="node",e.BUBBLE_CLASS="bubble",e.MIN_RADIUS=10,e=n.colorMixin(e),e.renderLabel(!0),e.data(function(t){return t.top(1/0)});var a=t.scale.linear().domain([0,100]),o=function(t){return t.r};e.r=function(t){return arguments.length?(a=t,e):a},e.radiusValueAccessor=function(t){return arguments.length?(o=t,e):o},e.rMin=function(){return t.min(e.data(),function(t){return e.radiusValueAccessor()(t)})},e.rMax=function(){return t.max(e.data(),function(t){return e.radiusValueAccessor()(t)})},e.bubbleR=function(t){var n=e.radiusValueAccessor()(t),r=e.r()(n);return(isNaN(r)||n<=0)&&(r=0),r};var u=function(t){return e.label()(t)},l=function(t){return e.bubbleR(t)>i?1:0};e._doRenderLabel=function(t){if(e.renderLabel()){var r=t.select("text");r.empty()&&(r=t.append("text").attr("text-anchor","middle").attr("dy",".3em").on("click",e.onClick)),r.attr("opacity",0).text(u),n.transition(r,e.transitionDuration()).attr("opacity",l)}},e.doUpdateLabels=function(t){if(e.renderLabel()){var r=t.selectAll("text").text(u);n.transition(r,e.transitionDuration()).attr("opacity",l)}};var s=function(t){return e.title()(t)};return e._doRenderTitles=function(t){if(e.renderTitle()){t.select("title").empty()&&t.append("title").text(s)}},e.doUpdateTitles=function(t){e.renderTitle()&&t.selectAll("title").text(s)},e.minRadiusWithLabel=function(t){return arguments.length?(i=t,e):i},e.maxBubbleRelativeSize=function(t){return arguments.length?(r=t,e):r},e.fadeDeselectedArea=function(){e.hasFilter()?e.selectAll("g."+e.BUBBLE_NODE_CLASS).each(function(t){e.isSelectedNode(t)?e.highlightSelected(this):e.fadeDeselected(this)}):e.selectAll("g."+e.BUBBLE_NODE_CLASS).each(function(){e.resetHighlight(this)})},e.isSelectedNode=function(t){return e.hasFilter(t.key)},e.onClick=function(t){var r=t.key;n.events.trigger(function(){e.filter(r),e.redrawGroup()})},e},n.pieChart=function(e,r){function i(){R=R?R:t.min([G.width(),G.height()])/2;var e,n=x(),r=y();if(t.sum(G.data(),G.valueAccessor())?(e=r(G.data()),S.classed(T,!1)):(e=r([{key:N,value:1,others:[N]}]),S.classed(T,!0)),S){var i=S.selectAll("g."+B).data(e);a(i,n,e),d(e,n),p(i),m()}}function a(t,e,n){var r=o(t);u(r,e),l(r),c(n,e)}function o(t){return t.enter().append("g").attr("class",function(t,e){return B+" _"+e})}function u(t,e){var r=t.append("path").attr("fill",w).on("click",D).attr("d",function(t,n){return C(t,n,e)});n.transition(r,G.transitionDuration(),function(t){t.attrTween("d",_)})}function l(t){G.renderTitle()&&t.append("title").text(function(t){return G.title()(t)})}function s(t,e){n.transition(t,G.transitionDuration()).attr("transform",function(t){return L(t,e)}).attr("text-anchor","middle").text(function(t){return!b(t.data)&&!A(t)||v(t)?G.label()(t.data):""})}function c(t,e){if(G.renderLabel()){var n=S.selectAll("text."+B).data(t);n.exit().remove();s(n.enter().append("text").attr("class",function(t,e){var n=B+" _"+e;return F&&(n+=" external"),n}).on("click",D),e)}}function d(t,e){f(t,e),h(t,e),g(t)}function f(t,e){var r=S.selectAll("g."+B).data(t).select("path").attr("d",function(t,n){return C(t,n,e)});n.transition(r,G.transitionDuration(),function(t){t.attrTween("d",_)}).attr("fill",w)}function h(t,e){if(G.renderLabel()){s(S.selectAll("text."+B).data(t),e)}}function g(t){G.renderTitle()&&S.selectAll("g."+B).data(t).select("title").text(function(t){return G.title()(t.data)})}function p(t){t.exit().remove()}function m(){G.hasFilter()?G.selectAll("g."+B).each(function(t){v(t)?G.highlightSelected(this):G.fadeDeselected(this)}):G.selectAll("g."+B).each(function(){G.resetHighlight(this)})}function x(){return t.svg.arc().outerRadius(R).innerRadius(P)}function v(t){return G.hasFilter(G.cappedKeyAccessor(t.data))}function y(){return t.layout.pie().sort(null).value(G.cappedValueAccessor)}function A(t){var e=t.endAngle-t.startAngle;return isNaN(e)||e<H}function b(t){return 0===G.cappedValueAccessor(t)}function _(e){e.innerRadius=P;var n=this._current;k(n)&&(n={startAngle:0,endAngle:0});var r=t.interpolate(n,e);return this._current=r(0),function(t){return C(r(t),0,x())}}function k(t){return!t||isNaN(t.startAngle)||isNaN(t.endAngle)}function w(t,e){return G.getColor(t.data,e)}function D(t,e){S.attr("class")!==T&&G.onClick(t.data,e)}function C(t,e,n){var r=n(t,e);return r.indexOf("NaN")>=0&&(r="M0,0"),r}function L(e,n){var r;return r=F?t.svg.arc().outerRadius(R+F).innerRadius(R+F).centroid(e):n.centroid(e),isNaN(r[0])||isNaN(r[1])?"translate(0,0)":"translate("+r+")"}function E(e,n){G.selectAll("g.pie-slice").each(function(r){e.name===r.data.key&&t.select(this).classed("highlight",n)})}
var R,S,O,M,F,B="pie-slice",T="empty-chart",N="empty",P=0,H=.5,G=n.capMixin(n.colorMixin(n.baseMixin({})));return G.colorAccessor(G.cappedKeyAccessor),G.title(function(t){return G.cappedKeyAccessor(t)+": "+G.cappedValueAccessor(t)}),G.slicesCap=G.cap,G.label(G.cappedKeyAccessor),G.renderLabel(!0),G.transitionDuration(350),G._doRender=function(){return G.resetSvg(),S=G.svg().append("g").attr("transform","translate("+G.cx()+","+G.cy()+")"),i(),G},G.innerRadius=function(t){return arguments.length?(P=t,G):P},G.radius=function(t){return arguments.length?(R=t,G):R},G.cx=function(t){return arguments.length?(O=t,G):O||G.width()/2},G.cy=function(t){return arguments.length?(M=t,G):M||G.height()/2},G._doRedraw=function(){return i(),G},G.minAngleForLabel=function(t){return arguments.length?(H=t,G):H},G.emptyTitle=function(t){return 0===arguments.length?N:(N=t,G)},G.externalLabels=function(t){return 0===arguments.length?F:(F=t?t:void 0,G)},G.legendables=function(){return G.data().map(function(t,e){var n={name:t.key,data:t.value,others:t.others,chart:G};return n.color=G.getColor(t,e),n})},G.legendHighlight=function(t){E(t,!0)},G.legendReset=function(t){E(t,!1)},G.legendToggle=function(t){G.onClick({key:t.name,others:t.others})},G.anchor(e,r)},n.barChart=function(e,r){function i(t){return n.utils.safeNumber(Math.abs(c.y()(t.y+t.y0)-c.y()(t.y0)))}function a(t,e,r){var a=t.selectAll("rect.bar").data(r.values,n.pluck("x")),o=a.enter().append("rect").attr("class","bar").attr("fill",n.pluck("data",c.getColor)).attr("y",c.yAxisHeight()).attr("height",0);c.renderTitle()&&o.append("title").text(n.pluck("data",c.title(r.name))),c.isOrdinal()&&a.on("click",c.onClick),n.transition(a,c.transitionDuration()).attr("x",function(t){var e=c.x()(t.x);return f&&(e-=l/2),c.isOrdinal()&&void 0!==d&&(e+=d/2),n.utils.safeNumber(e)}).attr("y",function(t){var e=c.y()(t.y+t.y0);return t.y<0&&(e-=i(t)),n.utils.safeNumber(e)}).attr("width",l).attr("height",function(t){return i(t)}).attr("fill",n.pluck("data",c.getColor)).select("title").text(n.pluck("data",c.title(r.name))),n.transition(a.exit(),c.transitionDuration()).attr("height",0).remove()}function o(){if(void 0===l){var t=c.xUnitCount();l=c.isOrdinal()&&void 0===d?Math.floor(c.x().rangeBand()):d?Math.floor((c.xAxisLength()-(t-1)*d)/t):Math.floor(c.xAxisLength()/(1+c.barPadding())/t),(l===1/0||isNaN(l)||l<s)&&(l=s)}}function u(e,n){return function(){var r=t.select(this),i=r.attr("fill")===e;return n?!i:i}}var l,s=1,c=n.stackMixin(n.coordinateGridMixin({})),d=2,f=!1,h=!1;return n.override(c,"rescale",function(){c._rescale(),l=void 0}),n.override(c,"render",function(){c.round()&&f&&!h&&n.logger.warn("By default, brush rounding is disabled if bars are centered. See dc.js bar chart API documentation for details."),c._render()}),c.plotData=function(){var e=c.chartBodyG().selectAll("g.stack").data(c.data());o(),e.enter().append("g").attr("class",function(t,e){return"stack _"+e}),e.each(function(e,n){a(t.select(this),n,e)})},c.fadeDeselectedArea=function(){var t=c.chartBodyG().selectAll("rect.bar"),e=c.brush().extent();if(c.isOrdinal())c.hasFilter()?(t.classed(n.constants.SELECTED_CLASS,function(t){return c.hasFilter(t.x)}),t.classed(n.constants.DESELECTED_CLASS,function(t){return!c.hasFilter(t.x)})):(t.classed(n.constants.SELECTED_CLASS,!1),t.classed(n.constants.DESELECTED_CLASS,!1));else if(c.brushIsEmpty(e))t.classed(n.constants.DESELECTED_CLASS,!1);else{var r=e[0],i=e[1];t.classed(n.constants.DESELECTED_CLASS,function(t){return t.x<r||t.x>=i})}},c.centerBar=function(t){return arguments.length?(f=t,c):f},n.override(c,"onClick",function(t){c._onClick(t.data)}),c.barPadding=function(t){return arguments.length?(c._rangeBandPadding(t),d=void 0,c):c._rangeBandPadding()},c._useOuterPadding=function(){return void 0===d},c.outerPadding=c._outerRangeBandPadding,c.gap=function(t){return arguments.length?(d=t,c):d},c.extendBrush=function(){var t=c.brush().extent();return!c.round()||f&&!h||(t[0]=t.map(c.round())[0],t[1]=t.map(c.round())[1],c.chartBodyG().select(".brush").call(c.brush().extent(t))),t},c.alwaysUseRounding=function(t){return arguments.length?(h=t,c):h},c.legendHighlight=function(t){c.isLegendableHidden(t)||c.g().selectAll("rect.bar").classed("highlight",u(t.color)).classed("fadeout",u(t.color,!0))},c.legendReset=function(){c.g().selectAll("rect.bar").classed("highlight",!1).classed("fadeout",!1)},n.override(c,"xAxisMax",function(){var t=this._xAxisMax();if("resolution"in c.xUnits()){t+=c.xUnits().resolution}return t}),c.anchor(e,r)},n.lineChart=function(e,r){function i(t,e){return k.getColor.call(t,t.values,e)}function a(e,r){var a=t.svg.line().x(function(t){return k.x()(t.x)}).y(function(t){return k.y()(t.y+t.y0)}).interpolate(R).tension(S);x&&a.defined(x);var o=e.append("path").attr("class","line").attr("stroke",i);v&&o.attr("stroke-dasharray",v),n.transition(r.select("path.line"),k.transitionDuration()).attr("stroke",i).attr("d",function(t){return u(a(t.values))})}function o(e,r){if(w){var a=t.svg.area().x(function(t){return k.x()(t.x)}).y(function(t){return k.y()(t.y+t.y0)}).y0(function(t){return k.y()(t.y0)}).interpolate(R).tension(S);x&&a.defined(x),e.append("path").attr("class","area").attr("fill",i).attr("d",function(t){return u(a(t.values))}),n.transition(r.select("path.area"),k.transitionDuration()).attr("fill",i).attr("d",function(t){return u(a(t.values))})}}function u(t){return!t||t.indexOf("NaN")>=0?"M0,0":t}function l(e,r){if(!k.brushOn()){var i=y+"-list",a=e.select("g."+i);a.empty()&&(a=e.append("g").attr("class",i)),r.each(function(e,r){var i=e.values;x&&(i=i.filter(x));var o=a.select("g."+y+"._"+r);o.empty()&&(o=a.append("g").attr("class",y+" _"+r)),s(o);var u=o.selectAll("circle."+A).data(i,n.pluck("x"));u.enter().append("circle").attr("class",A).attr("r",f()).style("fill-opacity",L).style("stroke-opacity",E).on("mousemove",function(){var e=t.select(this);c(e),d(e,o)}).on("mouseout",function(){h(t.select(this)),g(o)}),u.attr("cx",function(t){return n.utils.safeNumber(k.x()(t.x))}).attr("cy",function(t){return n.utils.safeNumber(k.y()(t.y+t.y0))}).attr("fill",k.getColor).call(p,e),u.exit().remove()})}}function s(t){(t.select("path."+b).empty()?t.append("path").attr("class",b):t.select("path."+b)).style("display","none").attr("stroke-dasharray","5,5"),(t.select("path."+_).empty()?t.append("path").attr("class",_):t.select("path."+_)).style("display","none").attr("stroke-dasharray","5,5")}function c(t){return t.style("fill-opacity",.8),t.style("stroke-opacity",.8),t.attr("r",D),t}function d(t,e){var n=t.attr("cx"),r=t.attr("cy"),i=k._yAxisX()-k.margins().left,a="M"+i+" "+r+"L"+n+" "+r,o="M"+n+" "+k.yAxisHeight()+"L"+n+" "+r;e.select("path."+b).style("display","").attr("d",a),e.select("path."+_).style("display","").attr("d",o)}function f(){return C||D}function h(t){t.style("fill-opacity",L).style("stroke-opacity",E).attr("r",f())}function g(t){t.select("path."+b).style("display","none"),t.select("path."+_).style("display","none")}function p(t,e){k.renderTitle()&&(t.selectAll("title").remove(),t.append("title").text(n.pluck("data",k.title(e.name))))}function m(e,n,r){return function(){var i=t.select(this),a=i.attr("stroke")===e&&i.attr("stroke-dasharray")===(n instanceof Array?n.join(","):null)||i.attr("fill")===e;return r?!a:a}}var x,v,y="dc-tooltip",A="dot",b="yRef",_="xRef",k=n.stackMixin(n.coordinateGridMixin({})),w=!1,D=5,C=null,L=1e-6,E=1e-6,R="linear",S=.7;return k.transitionDuration(500),k._rangeBandPadding(1),k.plotData=function(){var t=k.chartBodyG(),e=t.selectAll("g.stack-list");e.empty()&&(e=t.append("g").attr("class","stack-list"));var n=e.selectAll("g.stack").data(k.data()),r=n.enter().append("g").attr("class",function(t,e){return"stack _"+e});a(r,n),o(r,n),l(t,n)},k.interpolate=function(t){return arguments.length?(R=t,k):R},k.tension=function(t){return arguments.length?(S=t,k):S},k.defined=function(t){return arguments.length?(x=t,k):x},k.dashStyle=function(t){return arguments.length?(v=t,k):v},k.renderArea=function(t){return arguments.length?(w=t,k):w},k.dotRadius=function(t){return arguments.length?(D=t,k):D},k.renderDataPoints=function(t){return arguments.length?(t?(L=t.fillOpacity||.8,E=t.strokeOpacity||.8,C=t.radius||2):(L=1e-6,E=1e-6,C=null),k):{fillOpacity:L,strokeOpacity:E,radius:C}},k.legendHighlight=function(t){k.isLegendableHidden(t)||k.g().selectAll("path.line, path.area").classed("highlight",m(t.color,t.dashstyle)).classed("fadeout",m(t.color,t.dashstyle,!0))},k.legendReset=function(){k.g().selectAll("path.line, path.area").classed("highlight",!1).classed("fadeout",!1)},n.override(k,"legendables",function(){var t=k._legendables();return v?t.map(function(t){return t.dashstyle=v,t}):t}),k.anchor(e,r)},n.dataCount=function(e,r){var i=t.format(",d"),a=n.baseMixin({}),o={some:"",all:""};return a.html=function(t){return arguments.length?(t.all&&(o.all=t.all),t.some&&(o.some=t.some),a):o},a.formatNumber=function(t){return arguments.length?(i=t,a):i},a._doRender=function(){var t=a.dimension().size(),e=a.group().value(),n=i(t),r=i(e);return t===e&&""!==o.all?a.root().html(o.all.replace("%total-count",n).replace("%filter-count",r)):""!==o.some?a.root().html(o.some.replace("%total-count",n).replace("%filter-count",r)):(a.selectAll(".total-count").text(n),a.selectAll(".filter-count").text(r)),a},a._doRedraw=function(){return a._doRender()},a.anchor(e,r)},n.dataTable=function(e,r){function i(){var t=!0;if(g.forEach(function(e){t&="function"==typeof e}),!t){f.selectAll("th").remove();f.root().selectAll("th").data(g).enter().append("th").attr("class",d).html(function(t){return f._doColumnHeaderFormat(t)})}var e=f.root().selectAll("tbody").data(a(),function(t){return f.keyAccessor()(t)}),n=e.enter().append("tbody");return n.append("tr").attr("class",c).append("td").attr("class",u).attr("colspan",g.length).html(function(t){return f.keyAccessor()(t)}),e.exit().remove(),n}function a(){var e;return e=m===t.ascending?f.dimension().bottom(h):f.dimension().top(h),t.nest().key(f.group()).sortKeys(m).entries(e.sort(function(t,e){return m(p(t),p(e))}))}function o(t){var e=t.order().selectAll("tr."+l).data(function(t){return t.values}),n=e.enter().append("tr").attr("class",l);return g.forEach(function(t,e){n.append("td").attr("class",s+" _"+e).html(function(e){return f._doColumnValueFormat(t,e)})}),e.exit().remove(),e}var u="dc-table-label",l="dc-table-row",s="dc-table-column",c="dc-table-group",d="dc-table-head",f=n.baseMixin({}),h=25,g=[],p=function(t){return t},m=t.ascending;return f._doRender=function(){return f.selectAll("tbody").remove(),o(i()),f},f._doColumnValueFormat=function(t,e){return"function"==typeof t?t(e):"string"==typeof t?e[t]:t.format(e)},f._doColumnHeaderFormat=function(t){return"function"==typeof t?f._doColumnHeaderFnToString(t):"string"==typeof t?f._doColumnHeaderCapitalize(t):String(t.label)},f._doColumnHeaderCapitalize=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},f._doColumnHeaderFnToString=function(t){var e=String(t),n=e.indexOf("return ");if(n>=0){var r=e.lastIndexOf(";");if(r>=0){e=e.substring(n+7,r);e.indexOf("numberFormat")>=0&&(e=e.replace("numberFormat",""))}}return e},f._doRedraw=function(){return f._doRender()},f.size=function(t){return arguments.length?(h=t,f):h},f.columns=function(t){return arguments.length?(g=t,f):g},f.sortBy=function(t){return arguments.length?(p=t,f):p},f.order=function(t){return arguments.length?(m=t,f):m},f.anchor(e,r)},n.dataGrid=function(e,r){function i(){var t=s.root().selectAll("div."+l).data(a(),function(t){return s.keyAccessor()(t)}),e=t.enter().append("div").attr("class",l);return g&&e.html(function(t){return g(t)}),t.exit().remove(),e}function a(){var e=s.dimension().top(c);return t.nest().key(s.group()).sortKeys(h).entries(e.sort(function(t,e){return h(f(t),f(e))}))}function o(t){var e=t.order().selectAll("div."+u).data(function(t){return t.values});return e.enter().append("div").attr("class",u).html(function(t){return d(t)}),e.exit().remove(),e}var u="dc-grid-item",l="dc-grid-top",s=n.baseMixin({}),c=999,d=function(t){return"you need to provide an html() handling param:  "+JSON.stringify(t)},f=function(t){return t},h=t.ascending,g=function(t){return"<div class='dc-grid-group'><h1 class='dc-grid-label'>"+s.keyAccessor()(t)+"</h1></div>"};return s._doRender=function(){return s.selectAll("div."+l).remove(),o(i()),s},s._doRedraw=function(){return s._doRender()},s.size=function(t){return arguments.length?(c=t,s):c},s.html=function(t){return arguments.length?(d=t,s):d},s.htmlGroup=function(t){return arguments.length?(g=t,s):g},s.sortBy=function(t){return arguments.length?(f=t,s):f},s.order=function(t){return arguments.length?(h=t,s):h},s.anchor(e,r)},n.bubbleChart=function(t,e){function r(t){var e=t.enter().append("g");e.attr("class",l.BUBBLE_NODE_CLASS).attr("transform",c).append("circle").attr("class",function(t,e){return l.BUBBLE_CLASS+" _"+e}).on("click",l.onClick).attr("fill",l.getColor).attr("r",0),n.transition(t,l.transitionDuration()).selectAll("circle."+l.BUBBLE_CLASS).attr("r",function(t){return l.bubbleR(t)}).attr("opacity",function(t){return l.bubbleR(t)>0?1:0}),l._doRenderLabel(e),l._doRenderTitles(e)}function i(t){n.transition(t,l.transitionDuration()).attr("transform",c).selectAll("circle."+l.BUBBLE_CLASS).attr("fill",l.getColor).attr("r",function(t){return l.bubbleR(t)}).attr("opacity",function(t){return l.bubbleR(t)>0?1:0}),l.doUpdateLabels(t),l.doUpdateTitles(t)}function a(t){t.exit().remove()}function o(t){var e=l.x()(l.keyAccessor()(t));return isNaN(e)&&(e=0),e}function u(t){var e=l.y()(l.valueAccessor()(t));return isNaN(e)&&(e=0),e}var l=n.bubbleMixin(n.coordinateGridMixin({})),s=!1;l.transitionDuration(750);var c=function(t){return"translate("+o(t)+","+u(t)+")"};return l.elasticRadius=function(t){return arguments.length?(s=t,l):s},l.plotData=function(){s&&l.r().domain([l.rMin(),l.rMax()]),l.r().range([l.MIN_RADIUS,l.xAxisLength()*l.maxBubbleRelativeSize()]);var t=l.chartBodyG().selectAll("g."+l.BUBBLE_NODE_CLASS).data(l.data(),function(t){return t.key});r(t),i(t),a(t),l.fadeDeselectedArea()},l.renderBrush=function(){},l.redrawBrush=function(){l.fadeDeselectedArea()},l.anchor(t,e)},n.compositeChart=function(e,r){function i(){(void 0===y.rightY()||y.elasticY())&&(y.rightY(t.scale.linear()),y.rightY().domain([d(),g()]).rangeRound([y.yAxisHeight(),0])),y.rightY().range([y.yAxisHeight(),0]),y.rightYAxis(y.rightYAxis().scale(y.rightY())),y.rightYAxis().orient("right")}function a(){(void 0===y.y()||y.elasticY())&&(y.y(t.scale.linear()),y.y().domain([c(),h()]).rangeRound([y.yAxisHeight(),0])),y.y().range([y.yAxisHeight(),0]),y.yAxis(y.yAxis().scale(y.y())),y.yAxis().orient("left")}function o(t,e){t._generateG(y.g()),t.g().attr("class",v+" _"+e)}function u(){return A.filter(function(t){return!t.useRightYAxis()})}function l(){return A.filter(function(t){return t.useRightYAxis()})}function s(t){return t.map(function(t){return t.yAxisMin()})}function c(){return t.min(s(u()))}function d(){return t.min(s(l()))}function f(t){return t.map(function(t){return t.yAxisMax()})}function h(){return n.utils.add(t.max(f(u())),y.yAxisPadding())}function g(){return n.utils.add(t.max(f(l())),y.yAxisPadding())}function p(){return A.map(function(t){return t.xAxisMin()})}function m(){return A.map(function(t){return t.xAxisMax()})}var x,v="sub",y=n.coordinateGridMixin({}),A=[],b={},_=!1,k=!0,w=t.svg.axis(),D=0,C=12,L=!1;return y._mandatoryAttributes([]),y.transitionDuration(500),n.override(y,"_generateG",function(){for(var t=this.__generateG(),e=0;e<A.length;++e){var n=A[e];o(n,e),n.dimension()||n.dimension(y.dimension()),n.group()||n.group(y.group()),n.chartGroup(y.chartGroup()),n.svg(y.svg()),n.xUnits(y.xUnits()),n.transitionDuration(y.transitionDuration()),n.brushOn(y.brushOn()),n.renderTitle(y.renderTitle())}return t}),y._brushing=function(){for(var t=y.extendBrush(),e=y.brushIsEmpty(t),n=0;n<A.length;++n)A[n].filter(null),e||A[n].filter(t)},y._prepareYAxis=function(){0!==u().length&&a(),0!==l().length&&i(),u().length>0&&!L?y._renderHorizontalGridLinesForAxis(y.g(),y.y(),y.yAxis()):l().length>0&&y._renderHorizontalGridLinesForAxis(y.g(),x,w)},y.renderYAxis=function(){0!==u().length&&(y.renderYAxisAt("y",y.yAxis(),y.margins().left),y.renderYAxisLabel("y",y.yAxisLabel(),-90)),0!==l().length&&(y.renderYAxisAt("yr",y.rightYAxis(),y.width()-y.margins().right),y.renderYAxisLabel("yr",y.rightYAxisLabel(),90,y.width()-C))},y.plotData=function(){for(var t=0;t<A.length;++t){var e=A[t];e.g()||o(e,t),_&&e.colors(y.colors()),e.x(y.x()),e.xAxis(y.xAxis()),e.useRightYAxis()?(e.y(y.rightY()),e.yAxis(y.rightYAxis())):(e.y(y.y()),e.yAxis(y.yAxis())),e.plotData(),e._activateRenderlets()}},y.useRightAxisGridLines=function(t){return arguments?(L=t,y):L},y.childOptions=function(t){return arguments.length?(b=t,A.forEach(function(t){t.options(b)}),y):b},y.fadeDeselectedArea=function(){for(var t=0;t<A.length;++t){var e=A[t];e.brush(y.brush()),e.fadeDeselectedArea()}},y.rightYAxisLabel=function(t,e){return arguments.length?(D=t,y.margins().right-=C,C=void 0===e?12:e,y.margins().right+=C,y):D},y.compose=function(t){return A=t,A.forEach(function(t){t.height(y.height()),t.width(y.width()),t.margins(y.margins()),k&&t.title(y.title()),t.options(b)}),y},y.children=function(){return A},y.shareColors=function(t){return arguments.length?(_=t,y):_},y.shareTitle=function(t){return arguments.length?(k=t,y):k},y.rightY=function(t){return arguments.length?(x=t,y):x},delete y.yAxisMin,delete y.yAxisMax,n.override(y,"xAxisMin",function(){return n.utils.subtract(t.min(p()),y.xAxisPadding())}),n.override(y,"xAxisMax",function(){return n.utils.add(t.max(m()),y.xAxisPadding())}),y.legendables=function(){return A.reduce(function(t,e){return _&&e.colors(y.colors()),t.push.apply(t,e.legendables()),t},[])},y.legendHighlight=function(t){for(var e=0;e<A.length;++e){A[e].legendHighlight(t)}},y.legendReset=function(t){for(var e=0;e<A.length;++e){A[e].legendReset(t)}},y.legendToggle=function(){console.log("composite should not be getting legendToggle itself")},y.rightYAxis=function(t){return arguments.length?(w=t,y):w},y.anchor(e,r)},n.seriesChart=function(e,r){function i(e,n){return t.ascending(l.keyAccessor()(e),l.keyAccessor()(n))}function a(t){s[t].g()&&s[t].g().remove(),delete s[t]}function o(){Object.keys(s).map(a),s={}}var u,l=n.compositeChart(e,r),s={},c=n.lineChart,d=t.ascending,f=i;return l._mandatoryAttributes().push("seriesAccessor","chart"),l.shareColors(!0),l._preprocessData=function(){var e,n=[],i=t.nest().key(u);d&&i.sortKeys(d),f&&i.sortValues(f);var o=i.entries(l.data()),h=o.map(function(i,a){var o=s[i.key]||c.call(l,l,r,i.key,a);return s[i.key]||(e=!0),s[i.key]=o,n.push(i.key),o.dimension(l.dimension()).group({all:t.functor(i.values)},i.key).keyAccessor(l.keyAccessor()).valueAccessor(l.valueAccessor()).brushOn(l.brushOn())});Object.keys(s).filter(function(t){return n.indexOf(t)===-1}).forEach(function(t){a(t),e=!0}),l._compose(h),e&&l.legend()&&l.legend().render()},l.chart=function(t){return arguments.length?(c=t,o(),l):c},l.seriesAccessor=function(t){return arguments.length?(u=t,o(),l):u},l.seriesSort=function(t){return arguments.length?(d=t,o(),l):d},l.valueSort=function(t){return arguments.length?(f=t,o(),l):f},l._compose=l.compose,delete l.compose,l},n.geoChoroplethChart=function(e,r){function i(t){var e=a();if(o(t)){var n=u(t);h(n,t,e),g(n,t,e)}}function a(){for(var t={},e=p.data(),n=0;n<e.length;++n)t[p.keyAccessor()(e[n])]=p.valueAccessor()(e[n]);return t}function o(t){return f(t).keyAccessor}function u(t){return p.svg().selectAll(l(t)).classed("selected",function(e){return s(t,e)}).classed("deselected",function(e){return c(t,e)}).attr("class",function(e){var r=f(t).name,i=n.utils.nameToId(f(t).keyAccessor(e)),a=r+" "+i;return s(t,e)&&(a+=" selected"),c(t,e)&&(a+=" deselected"),a})}function l(t){return"g.layer"+t+" g."+f(t).name}function s(t,e){return p.hasFilter()&&p.hasFilter(d(t,e))}function c(t,e){return p.hasFilter()&&!p.hasFilter(d(t,e))}function d(t,e){return f(t).keyAccessor(e)}function f(t){return v[t]}function h(e,r,i){var a=e.select("path").attr("fill",function(){var e=t.select(this).attr("fill");return e?e:"none"}).on("click",function(t){return p.onClick(t,r)});n.transition(a,p.transitionDuration()).attr("fill",function(t,e){return p.getColor(i[f(r).keyAccessor(t)],e)})}function g(t,e,n){p.renderTitle()&&t.selectAll("title").text(function(t){var r=d(e,t),i=n[r];return p.title()({key:r,value:i})})}var p=n.colorMixin(n.baseMixin({}));p.colorAccessor(function(t){return t||0});var m,x=t.geo.path(),v=[];return p._doRender=function(){p.resetSvg();for(var t=0;t<v.length;++t){var e=p.svg().append("g").attr("class","layer"+t),n=e.selectAll("g."+f(t).name).data(f(t).data).enter().append("g").attr("class",f(t).name);n.append("path").attr("fill","white").attr("d",x),n.append("title"),i(t)}m=!1},p.onClick=function(t,e){var r=f(e).keyAccessor(t);n.events.trigger(function(){p.filter(r),p.redrawGroup()})},p._doRedraw=function(){for(var t=0;t<v.length;++t)i(t),m&&p.svg().selectAll("g."+f(t).name+" path").attr("d",x);m=!1},p.overlayGeoJson=function(t,e,n){for(var r=0;r<v.length;++r)if(v[r].name===e)return v[r].data=t,v[r].keyAccessor=n,p;return v.push({name:e,data:t,keyAccessor:n}),p},p.projection=function(t){return x.projection(t),m=!0,p},p.geoJsons=function(){return v},p.geoPath=function(){return x},p.removeGeoJson=function(t){for(var e=[],n=0;n<v.length;++n){var r=v[n];r.name!==t&&e.push(r)}return v=e,p},p.anchor(e,r)},n.bubbleOverlay=function(e,r){function i(){return s=h.select("g."+c),s.empty()&&(s=h.svg().append("g").attr("class",c)),s}function a(){var t=o();g.forEach(function(e){var r=u(e,t),i=r.select("circle."+f);i.empty()&&(i=r.append("circle").attr("class",f).attr("r",0).attr("fill",h.getColor).on("click",h.onClick)),n.transition(i,h.transitionDuration()).attr("r",function(t){return h.bubbleR(t)}),h._doRenderLabel(r),h._doRenderTitles(r)})}function o(){var t={};return h.data().forEach(function(e){t[h.keyAccessor()(e)]=e}),t}function u(t,e){var r=d+" "+n.utils.nameToId(t.name),i=s.select("g."+n.utils.nameToId(t.name));return i.empty()&&(i=s.append("g").attr("class",r).attr("transform","translate("+t.x+","+t.y+")")),i.datum(e[t.name]),i}function l(){var t=o();g.forEach(function(e){var r=u(e,t),i=r.select("circle."+f);n.transition(i,h.transitionDuration()).attr("r",function(t){return h.bubbleR(t)}).attr("fill",h.getColor),h.doUpdateLabels(r),h.doUpdateTitles(r)})}var s,c="bubble-overlay",d="node",f="bubble",h=n.bubbleMixin(n.baseMixin({})),g=[];return h.transitionDuration(750),h.radiusValueAccessor(function(t){return t.value}),h.point=function(t,e,n){return g.push({name:t,x:e,y:n}),h},h._doRender=function(){return s=i(),h.r().range([h.MIN_RADIUS,h.width()*h.maxBubbleRelativeSize()]),a(),h.fadeDeselectedArea(),h},h._doRedraw=function(){return l(),h.fadeDeselectedArea(),h},h.debug=function(e){if(e){var r=h.select("g."+n.constants.DEBUG_GROUP_CLASS);r.empty()&&(r=h.svg().append("g").attr("class",n.constants.DEBUG_GROUP_CLASS));var i=r.append("text").attr("x",10).attr("y",20);r.append("rect").attr("width",h.width()).attr("height",h.height()).on("mousemove",function(){var e=t.mouse(r.node()),n=e[0]+", "+e[1];i.text(n)})}else h.selectAll(".debug").remove();return h},h.anchor(e,r),h},n.rowChart=function(e,r){function i(){if(!y||A){var e=t.extent(b,M.cappedValueAccessor);e[0]>0&&(e[0]=0),y=t.scale.linear().domain(e).range([0,M.effectiveWidth()])}F.scale(y)}function a(){var t=v.select("g.axis");i(),t.empty()&&(t=v.append("g").attr("class","axis").attr("transform","translate(0, "+M.effectiveHeight()+")")),n.transition(t,M.transitionDuration()).call(F)}function o(){v.selectAll("g.tick").select("line.grid-line").remove(),v.selectAll("g.tick").append("line").attr("class","grid-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",function(){return-M.effectiveHeight()})}function u(){b=M.data(),a(),o();var t=v.selectAll("g."+R).data(b);l(t),s(t),d(t)}function l(t){var e=t.enter().append("g").attr("class",function(t,e){return R+" _"+e});e.append("rect").attr("width",0),h(e),g(t)}function s(t){t.exit().remove()}function c(){var t=y(0);return t===-(1/0)||t!==t?y(1):t}function d(t){var e,r=b.length;e=E?E:(M.effectiveHeight()-(r+1)*L)/r,w||(k=e/2);var i=t.attr("transform",function(t,n){return"translate(0,"+((n+1)*L+n*e)+")"}).select("rect").attr("height",e).attr("fill",M.getColor).on("click",p).classed("deselected",function(t){return!!M.hasFilter()&&!x(t)}).classed("selected",function(t){return!!M.hasFilter()&&x(t)});n.transition(i,M.transitionDuration()).attr("width",function(t){return Math.abs(c()-y(M.valueAccessor()(t)))}).attr("transform",m),f(t),g(t)}function f(t){M.renderTitle()&&(t.selectAll("title").remove(),t.append("title").text(M.title()))}function h(t){M.renderLabel()&&t.append("text").on("click",p),M.renderTitleLabel()&&t.append("text").attr("class",S).on("click",p)}function g(t){if(M.renderLabel()){var e=t.select("text").attr("x",_).attr("y",k).attr("dy",D).on("click",p).attr("class",function(t,e){return R+" _"+e}).text(function(t){return M.label()(t)});n.transition(e,M.transitionDuration()).attr("transform",m)}if(M.renderTitleLabel()){var r=t.select("."+S).attr("x",M.effectiveWidth()-C).attr("y",k).attr("text-anchor","end").on("click",p).attr("class",function(t,e){return S+" _"+e}).text(function(t){return M.title()(t)});n.transition(r,M.transitionDuration()).attr("transform",m)}}function p(t){M.onClick(t)}function m(t){var e=y(M.cappedValueAccessor(t)),n=c();return"translate("+(e>n?n:e)+",0)"}function x(t){return M.hasFilter(M.cappedKeyAccessor(t))}var v,y,A,b,_=10,k=15,w=!1,D="0.35em",C=2,L=5,E=!1,R="row",S="titlerow",O=!1,M=n.capMixin(n.marginMixin(n.colorMixin(n.baseMixin({})))),F=t.svg.axis().orient("bottom");return M.rowsCap=M.cap,M._doRender=function(){return M.resetSvg(),v=M.svg().append("g").attr("transform","translate("+M.margins().left+","+M.margins().top+")"),u(),M},M.title(function(t){return M.cappedKeyAccessor(t)+": "+M.cappedValueAccessor(t)}),M.label(M.cappedKeyAccessor),M.x=function(t){return arguments.length?(y=t,M):y},M.renderTitleLabel=function(t){return arguments.length?(O=t,M):O},M._doRedraw=function(){return u(),M},M.xAxis=function(){return F},M.fixedBarHeight=function(t){return arguments.length?(E=t,M):E},M.gap=function(t){return arguments.length?(L=t,M):L},M.elasticX=function(t){return arguments.length?(A=t,M):A},M.labelOffsetX=function(t){return arguments.length?(_=t,M):_},M.labelOffsetY=function(t){return arguments.length?(k=t,w=!0,M):k},M.titleLabelOffsetX=function(t){return arguments.length?(C=t,M):C},M.anchor(e,r)},n.legend=function(){function t(){return l+u}var e,r,i={},a=0,o=0,u=12,l=5,s=!1,c=560,d=70,f=!1;return i.parent=function(t){return arguments.length?(e=t,i):e},i.render=function(){e.svg().select("g.dc-legend").remove(),r=e.svg().append("g").attr("class","dc-legend").attr("transform","translate("+a+","+o+")");var i=e.legendables(),h=r.selectAll("g.dc-legend-item").data(i).enter().append("g").attr("class","dc-legend-item").on("mouseover",function(t){e.legendHighlight(t)}).on("mouseout",function(t){e.legendReset(t)}).on("click",function(t){t.chart.legendToggle(t)});r.selectAll("g.dc-legend-item").classed("fadeout",function(t){return t.chart.isLegendableHidden(t)}),i.some(n.pluck("dashstyle"))?h.append("line").attr("x1",0).attr("y1",u/2).attr("x2",u).attr("y2",u/2).attr("stroke-width",2).attr("stroke-dasharray",n.pluck("dashstyle")).attr("stroke",n.pluck("color")):h.append("rect").attr("width",u).attr("height",u).attr("fill",function(t){return t?t.color:"blue"}),h.append("text").text(n.pluck("name")).attr("x",u+2).attr("y",function(){return u/2+(this.clientHeight?this.clientHeight:13)/2-2});var g=0,p=0;h.attr("transform",function(e,n){if(s){var r="translate("+g+","+p*t()+")",i=f===!0?this.getBBox().width+l:d;return g+i>=c?(++p,g=0):g+=i,r}return"translate(0,"+n*t()+")"})},i.x=function(t){return arguments.length?(a=t,i):a},i.y=function(t){return arguments.length?(o=t,i):o},i.gap=function(t){return arguments.length?(l=t,i):l},i.itemHeight=function(t){return arguments.length?(u=t,i):u},i.horizontal=function(t){return arguments.length?(s=t,i):s},i.legendWidth=function(t){return arguments.length?(c=t,i):c},i.itemWidth=function(t){return arguments.length?(d=t,i):d},i.autoItemWidth=function(t){return arguments.length?(f=t,i):f},i},n.scatterPlot=function(e,r){function i(e,r){var i=o.selectAll(".chart-body path.symbol").filter(function(){return e(t.select(this))}),a=u.size();u.size(Math.pow(r,2)),n.transition(i,o.transitionDuration()).attr("d",u),u.size(a)}function a(t){var e=o.selectAll(".chart-body path.symbol").each(function(e){this.filtered=t&&t.isFiltered(e.key)});n.transition(e,o.transitionDuration()).attr("d",u)}var o=n.coordinateGridMixin({}),u=t.svg.symbol(),l=function(t){return t.value},s=o.keyAccessor();o.keyAccessor(function(t){return s(t)[0]}),o.valueAccessor(function(t){return s(t)[1]}),o.colorAccessor(function(){return o._groupName});var c=function(t){return"translate("+o.x()(o.keyAccessor()(t))+","+o.y()(o.valueAccessor()(t))+")"},d=3,f=5,h=0;return u.size(function(t){return l(t)?this.filtered?Math.pow(f,2):Math.pow(d,2):h}),n.override(o,"_filter",function(t){return arguments.length?o.__filter(n.filters.RangedTwoDimensionalFilter(t)):o.__filter()}),o.plotData=function(){var t=o.chartBodyG().selectAll("path.symbol").data(o.data());t.enter().append("path").attr("class","symbol").attr("opacity",0).attr("fill",o.getColor).attr("transform",c),n.transition(t,o.transitionDuration()).attr("opacity",function(t){return l(t)?1:0}).attr("fill",o.getColor).attr("transform",c).attr("d",u),n.transition(t.exit(),o.transitionDuration()).attr("opacity",0).remove()},o.existenceAccessor=function(t){return arguments.length?(l=t,this):l},o.symbol=function(t){return arguments.length?(u.type(t),o):u.type()},o.symbolSize=function(t){return arguments.length?(d=t,o):d},o.highlightedSize=function(t){return arguments.length?(f=t,o):f},o.hiddenSize=function(t){return arguments.length?(h=t,o):h},o.legendables=function(){return[{chart:o,name:o._groupName,color:o.getColor()}]},o.legendHighlight=function(e){i(function(t){return t.attr("fill")===e.color},f),o.selectAll(".chart-body path.symbol").filter(function(){return t.select(this).attr("fill")!==e.color}).classed("fadeout",!0)},o.legendReset=function(e){i(function(t){return t.attr("fill")===e.color},d),o.selectAll(".chart-body path.symbol").filter(function(){return t.select(this).attr("fill")!==e.color}).classed("fadeout",!1)},o.setHandlePaths=function(){},o.extendBrush=function(){var t=o.brush().extent();return o.round()&&(t[0]=t[0].map(o.round()),t[1]=t[1].map(o.round()),o.g().select(".brush").call(o.brush().extent(t))),t},o.brushIsEmpty=function(t){return o.brush().empty()||!t||t[0][0]>=t[1][0]||t[0][1]>=t[1][1]},o._brushing=function(){var t=o.extendBrush();if(o.redrawBrush(o.g()),o.brushIsEmpty(t))n.events.trigger(function(){o.filter(null),o.redrawGroup()}),a(!1);else{var e=n.filters.RangedTwoDimensionalFilter(t);n.events.trigger(function(){o.filter(null),o.filter(e),o.redrawGroup()},n.constants.EVENT_DELAY),a(e)}},o.setBrushY=function(t){t.call(o.brush().y(o.y()))},o.anchor(e,r)},n.numberDisplay=function(e,r){var i=t.format(".2s"),a=n.baseMixin({}),o={one:"",some:"",none:""};return a._mandatoryAttributes(["group"]),a.html=function(t){return arguments.length?(t.none?o.none=t.none:t.one?o.none=t.one:t.some&&(o.none=t.some),t.one?o.one=t.one:t.some&&(o.one=t.some),t.some?o.some=t.some:t.one&&(o.some=t.one),a):o},a.value=function(){return a.data()},a.data(function(t){var e=t.value?t.value():t.top(1)[0];return a.valueAccessor()(e)}),a.transitionDuration(250),a._doRender=function(){var e=a.value(),n=a.selectAll(".number-display");n.empty()&&(n=n.data([0]).enter().append("span").attr("class","number-display")),n.transition().duration(a.transitionDuration()).ease("quad-out-in").tween("text",function(){var n=t.interpolateNumber(this.lastValue||0,e)
;return this.lastValue=e,function(t){var r=null,i=a.formatNumber()(n(t));0===e&&""!==o.none?r=o.none:1===e&&""!==o.one?r=o.one:""!==o.some&&(r=o.some),this.innerHTML=r?r.replace("%number",i):i}})},a._doRedraw=function(){return a._doRender()},a.formatNumber=function(t){return arguments.length?(i=t,a):i},a.anchor(e,r)},n.heatMap=function(e,r){function i(t,e){var r=d.selectAll(".box-group").filter(function(n){return n.key[t]===e}),i=r.filter(function(t){return!d.hasFilter(t.key)});n.events.trigger(function(){i.empty()?r.each(function(t){d.filter(t.key)}):i.each(function(t){d.filter(t.key)}),d.redrawGroup()})}function a(t,e,n){return!e||n[e-1]!==t}var o,u,l,s=6.75,c=6.75,d=n.colorMixin(n.marginMixin(n.baseMixin({})));d._mandatoryAttributes(["group"]),d.title(d.colorAccessor());var f=function(t){return t},h=function(t){return t};d.colsLabel=function(t){return arguments.length?(f=t,d):f},d.rowsLabel=function(t){return arguments.length?(h=t,d):h};var g=function(t){i(0,t)},p=function(t){i(1,t)},m=function(t){var e=t.key;n.events.trigger(function(){d.filter(e),d.redrawGroup()})};return n.override(d,"filter",function(t){return arguments.length?d._filter(n.filters.TwoDimensionalFilter(t)):d._filter()}),d.rows=function(e){if(arguments.length)return l=e,d;if(l)return l;var n=d.data().map(d.valueAccessor());return n.sort(t.ascending),t.scale.ordinal().domain(n.filter(a))},d.cols=function(e){if(arguments.length)return u=e,d;if(u)return u;var n=d.data().map(d.keyAccessor());return n.sort(t.ascending),t.scale.ordinal().domain(n.filter(a))},d._doRender=function(){return d.resetSvg(),o=d.svg().append("g").attr("class","heatmap").attr("transform","translate("+d.margins().left+","+d.margins().top+")"),d._doRedraw()},d._doRedraw=function(){var t=d.rows(),e=d.cols(),r=t.domain().length,i=e.domain().length,a=Math.floor(d.effectiveWidth()/i),u=Math.floor(d.effectiveHeight()/r);e.rangeRoundBands([0,d.effectiveWidth()]),t.rangeRoundBands([d.effectiveHeight(),0]);var l=o.selectAll("g.box-group").data(d.data(),function(t,e){return d.keyAccessor()(t,e)+"\0"+d.valueAccessor()(t,e)}),f=l.enter().append("g").attr("class","box-group");f.append("rect").attr("class","heat-box").attr("fill","white").on("click",d.boxOnClick()),d.renderTitle()&&f.append("title").text(d.title()),n.transition(l.selectAll("rect"),d.transitionDuration()).attr("x",function(t,n){return e(d.keyAccessor()(t,n))}).attr("y",function(e,n){return t(d.valueAccessor()(e,n))}).attr("rx",s).attr("ry",c).attr("fill",d.getColor).attr("width",a).attr("height",u),l.exit().remove();var h=o.selectAll("g.cols");h.empty()&&(h=o.append("g").attr("class","cols axis"));var g=h.selectAll("text").data(e.domain());g.enter().append("text").attr("x",function(t){return e(t)+a/2}).style("text-anchor","middle").attr("y",d.effectiveHeight()).attr("dy",12).on("click",d.xAxisOnClick()).text(d.colsLabel()),n.transition(g,d.transitionDuration()).text(d.colsLabel()).attr("x",function(t){return e(t)+a/2}),g.exit().remove();var p=o.selectAll("g.rows");p.empty()&&(p=o.append("g").attr("class","rows axis"));var m=p.selectAll("text").data(t.domain());return m.enter().append("text").attr("dy",6).style("text-anchor","end").attr("x",0).attr("dx",-2).on("click",d.yAxisOnClick()).text(d.rowsLabel()),n.transition(m,d.transitionDuration()).text(d.rowsLabel()).attr("y",function(e){return t(e)+u/2}),m.exit().remove(),d.hasFilter()?d.selectAll("g.box-group").each(function(t){d.isSelectedNode(t)?d.highlightSelected(this):d.fadeDeselected(this)}):d.selectAll("g.box-group").each(function(){d.resetHighlight(this)}),d},d.boxOnClick=function(t){return arguments.length?(m=t,d):m},d.xAxisOnClick=function(t){return arguments.length?(g=t,d):g},d.yAxisOnClick=function(t){return arguments.length?(p=t,d):p},d.xBorderRadius=function(t){return arguments.length?(s=t,d):s},d.yBorderRadius=function(t){return arguments.length?(c=t,d):c},d.isSelectedNode=function(t){return d.hasFilter(t.key)},d.anchor(e,r)},function(){function e(t){return[0,t.length-1]}function n(e){return[t.quantile(e,.25),t.quantile(e,.5),t.quantile(e,.75)]}t.box=function(){function r(e){e.each(function(e,n){e=e.map(l).sort(t.ascending);var r=t.select(this),f=e.length,h=e[0],g=e[f-1],p=e.quartiles=c(e),m=s&&s.call(this,e,n),x=m&&m.map(function(t){return e[t]}),v=m?t.range(0,m[0]).concat(t.range(m[1]+1,f)):t.range(f),y=t.scale.linear().domain(u&&u.call(this,e,n)||[h,g]).range([a,0]),A=this.__chart__||t.scale.linear().domain([0,1/0]).range(y.range());this.__chart__=y;var b=r.selectAll("line.center").data(x?[x]:[]);b.enter().insert("line","rect").attr("class","center").attr("x1",i/2).attr("y1",function(t){return A(t[0])}).attr("x2",i/2).attr("y2",function(t){return A(t[1])}).style("opacity",1e-6).transition().duration(o).style("opacity",1).attr("y1",function(t){return y(t[0])}).attr("y2",function(t){return y(t[1])}),b.transition().duration(o).style("opacity",1).attr("y1",function(t){return y(t[0])}).attr("y2",function(t){return y(t[1])}),b.exit().transition().duration(o).style("opacity",1e-6).attr("y1",function(t){return y(t[0])}).attr("y2",function(t){return y(t[1])}).remove();var _=r.selectAll("rect.box").data([p]);_.enter().append("rect").attr("class","box").attr("x",0).attr("y",function(t){return A(t[2])}).attr("width",i).attr("height",function(t){return A(t[0])-A(t[2])}).transition().duration(o).attr("y",function(t){return y(t[2])}).attr("height",function(t){return y(t[0])-y(t[2])}),_.transition().duration(o).attr("y",function(t){return y(t[2])}).attr("height",function(t){return y(t[0])-y(t[2])});var k=r.selectAll("line.median").data([p[1]]);k.enter().append("line").attr("class","median").attr("x1",0).attr("y1",A).attr("x2",i).attr("y2",A).transition().duration(o).attr("y1",y).attr("y2",y),k.transition().duration(o).attr("y1",y).attr("y2",y);var w=r.selectAll("line.whisker").data(x||[]);w.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",A).attr("x2",i).attr("y2",A).style("opacity",1e-6).transition().duration(o).attr("y1",y).attr("y2",y).style("opacity",1),w.transition().duration(o).attr("y1",y).attr("y2",y).style("opacity",1),w.exit().transition().duration(o).attr("y1",y).attr("y2",y).style("opacity",1e-6).remove();var D=r.selectAll("circle.outlier").data(v,Number);D.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",i/2).attr("cy",function(t){return A(e[t])}).style("opacity",1e-6).transition().duration(o).attr("cy",function(t){return y(e[t])}).style("opacity",1),D.transition().duration(o).attr("cy",function(t){return y(e[t])}).style("opacity",1),D.exit().transition().duration(o).attr("cy",function(t){return y(e[t])}).style("opacity",1e-6).remove();var C=d||y.tickFormat(8),L=r.selectAll("text.box").data(p);L.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",function(t,e){return 1&e?6:-6}).attr("x",function(t,e){return 1&e?i:0}).attr("y",A).attr("text-anchor",function(t,e){return 1&e?"start":"end"}).text(C).transition().duration(o).attr("y",y),L.transition().duration(o).text(C).attr("y",y);var E=r.selectAll("text.whisker").data(x||[]);E.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",i).attr("y",A).text(C).style("opacity",1e-6).transition().duration(o).attr("y",y).style("opacity",1),E.transition().duration(o).text(C).attr("y",y).style("opacity",1),E.exit().transition().duration(o).attr("y",y).style("opacity",1e-6).remove()}),t.timer.flush()}var i=1,a=1,o=0,u=null,l=Number,s=e,c=n,d=null;return r.width=function(t){return arguments.length?(i=t,r):i},r.height=function(t){return arguments.length?(a=t,r):a},r.tickFormat=function(t){return arguments.length?(d=t,r):d},r.duration=function(t){return arguments.length?(o=t,r):o},r.domain=function(e){return arguments.length?(u=null===e?e:t.functor(e),r):u},r.value=function(t){return arguments.length?(l=t,r):l},r.whiskers=function(t){return arguments.length?(s=t,r):s},r.quartiles=function(t){return arguments.length?(c=t,r):c},r}}(),n.boxPlot=function(e,r){function i(t){return function(e){for(var n=e.quartiles[0],r=e.quartiles[2],i=(r-n)*t,a=-1,o=e.length;e[++a]<n-i;);for(;e[--o]>r+i;);return[a,o]}}function a(t){t.enter().append("g").attr("class","box").attr("transform",g).call(d).on("click",function(t){l.filter(t.key),l.redrawGroup()})}function o(e){n.transition(e,l.transitionDuration()).attr("transform",g).call(d).each(function(){t.select(this).select("rect.box").attr("fill",l.getColor)})}function u(t){t.exit().remove().call(d)}var l=n.coordinateGridMixin({}),s=i,c=s(1.5),d=t.box(),f=null,h=function(t,e){return l.isOrdinal()?l.x().rangeBand():t/(1+l.boxPadding())/e};l.yAxisPadding(12),l.x(t.scale.ordinal()),l.xUnits(n.units.ordinal),l.data(function(t){return t.all().map(function(t){return t.map=function(e){return e.call(t,t)},t}).filter(function(t){return 0!==l.valueAccessor()(t).length})}),l.boxPadding=l._rangeBandPadding,l.boxPadding(.8),l.outerPadding=l._outerRangeBandPadding,l.outerPadding(.5),l.boxWidth=function(e){return arguments.length?(h=t.functor(e),l):h};var g=function(t,e){return"translate("+l.x()(l.keyAccessor()(t,e))+", 0)"};return l._preprocessData=function(){l.elasticX()&&l.x().domain([])},l.plotData=function(){var t=h(l.effectiveWidth(),l.xUnitCount());d.whiskers(c).width(t).height(l.effectiveHeight()).value(l.valueAccessor()).domain(l.y().domain()).duration(l.transitionDuration()).tickFormat(f);var e=l.chartBodyG().selectAll("g.box").data(l.data(),function(t){return t.key});a(e),o(e),u(e),l.fadeDeselectedArea()},l.fadeDeselectedArea=function(){l.hasFilter()?l.g().selectAll("g.box").each(function(t){l.isSelectedNode(t)?l.highlightSelected(this):l.fadeDeselected(this)}):l.g().selectAll("g.box").each(function(){l.resetHighlight(this)})},l.isSelectedNode=function(t){return l.hasFilter(t.key)},l.yAxisMin=function(){var e=t.min(l.data(),function(e){return t.min(l.valueAccessor()(e))});return n.utils.subtract(e,l.yAxisPadding())},l.yAxisMax=function(){var e=t.max(l.data(),function(e){return t.max(l.valueAccessor()(e))});return n.utils.add(e,l.yAxisPadding())},l.tickFormat=function(t){return arguments.length?(f=t,l):f},l.anchor(e,r)},n.abstractBubbleChart=n.bubbleMixin,n.baseChart=n.baseMixin,n.capped=n.capMixin,n.colorChart=n.colorMixin,n.coordinateGridChart=n.coordinateGridMixin,n.marginable=n.marginMixin,n.stackableChart=n.stackMixin,n.d3=t,n.crossfilter=e,n}if("function"==typeof define&&define.amd)define(["d3","crossfilter"],t);else if("object"==typeof module&&module.exports){var e=require("d3"),n=require("crossfilter");"function"!=typeof n&&(n=n.crossfilter),module.exports=t(e,n)}else this.dc=t(d3,crossfilter)}();var PODLOVE=PODLOVE||{};PODLOVE.Analytics=PODLOVE.Analytics||{},PODLOVE.Analytics.decimalRound=function(t,e){var n=Math.pow(10,e);return t*=n,t=Math.round(t),t/=n},PODLOVE.Analytics.formatThousands=function(t){return t<1e3?t:PODLOVE.Analytics.decimalRound(t/1e3,1)+"k"},PODLOVE.Analytics.hourFormat=function(t){var e=0,n=0,r=[];return t>48&&(e=(t-t%24)/24,t%=24),e>13&&(n=(e-e%7)/7,e%=7),n&&r.push(PODLOVE.Analytics.decimalRound(n,1)+"w"),e&&r.push(PODLOVE.Analytics.decimalRound(e,1)+"d"),t&&r.push(PODLOVE.Analytics.decimalRound(t,1)+"h"),0===r.length&&(r=["0h"]),r.join(" ")},jQuery(document).ready(function(t){function e(e){var n=e.hours_per_unit,o=crossfilter(r),f=crossfilter(i),h=o.groupAll().reduce(s,c,d),g=function(e){var n=e.data(),r=e.filters();n.forEach(function(n,i){var a=e.select("g.row._"+i),o=e.select("g.row._"+i+" text"),u="";a.select(".subLabel").size()||a.append("text").attr("class","subLabel").attr("text-anchor","end").attr("x",-10).attr("y",o.attr("y")),r.length>0&&t.inArray(n.key,r)===-1?a.select(".subLabel").style({display:"none"}):a.select(".subLabel").style({display:"inherit"}),h.value().downloads>0&&(u=Math.round(n.value.downloads/h.value().downloads*100)+"%"),a.select(".subLabel").text(u)})},p=function(t,e){t.select(".reset").on("click",function(e,n){d3.event.preventDefault(),t.filterAll(),dc.redrawAll()})},m=function(t){return Math.floor(t.hoursSinceRelease/n)},x=o.dimension(m),v=f.dimension(m),y=o.dimension(function(t){return t.weekday}),A=o.dimension(function(t){return t.asset_id}),b=o.dimension(function(t){return t.client}),_=o.dimension(function(t){return t.system}),k=o.dimension(function(t){return t.source}),w=o.dimension(function(t){return t.context}),D=x.group().reduce(s,c,d),C=v.group().reduce(s,c,d),L=x.group().reduce(s,c,d).all().reduce(function(t,e){return e.key+=1,e.value.cum=!0,t.length&&(e.value.downloads+=t.slice(-1)[0].value.downloads),t.push(e),t},[]);L.unshift({key:0,value:{date:0,downloads:0,cum:!0}});var E={all:function(){return L}},R=y.group().reduce(s,c,d),S=A.group().reduce(s,c,d),O=b.group().reduce(s,c,d).order(function(t){return t.downloads}),M=_.group().reduce(s,c,d).order(function(t){return t.downloads}),F=k.group().reduce(s,c,d),B=w.group().reduce(s,c,d),T=dc.barChart(Y).dimension(x).group(D,"Current Episode").renderTitle(!0).valueAccessor(function(t){return t.value.downloads}).gap(1).colors("#69B3FF"),N=dc.barChart(Y).dimension(v).group(C,"Average Episode").renderTitle(!0).colors("#224BA6").valueAccessor(function(t){return t.value.downloads}).barPadding(2),P=dc.lineChart(Y).dimension(x).group(E,"Cumulative").colors("#CCC").useRightYAxis(!0).valueAccessor(function(t){return t.value.downloads}).renderDataPoints({}).renderArea(!0),H=D.all().reduce(function(t,e){return Math.max(t,e.key)},0),G=dc.barChart("#episode-range-chart").width(u).height(80).dimension(x).group(D).x(d3.scale.linear().domain([0,H])).valueAccessor(function(t){return t.value.downloads}).colors("#69B3FF").yAxisLabel(" "),Y=dc.compositeChart("#episode-performance-chart").width(u).x(d3.scale.linear().domain([0,1/0])).legend(dc.legend().x(u-160).y(20).itemHeight(13).gap(5)).elasticX(!0).elasticY(!0).brushOn(!1).transitionDuration(0).yAxisLabel("Downloads").xAxisLabel("Hours since release").rangeChart(G).title(function(t){var e=t.value.date?a(t.value.date):"Average Episode",r="";return r=t.value.cum?t.key*n+"h after release":t.key*n+"h – "+(t.key+1)*n+"h after release",[e,r,"Downloads: "+t.value.downloads].join("\n")}).compose([P,T,N]).rightYAxisLabel("Cumulative Downloads"),V=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],U=dc.rowChart("#episode-weekday-chart").margins({top:0,left:40,right:10,bottom:25}).group(R).dimension(y).elasticX(!0).label(function(t){return V[t.key]}).title(function(t){return t.value.downloads}).valueAccessor(function(t){return t.value?t.value.downloads:0}).ordering(function(t){return-t.value.downloads}).colors("#69B3FF").on("preRedraw",g).on("renderlet",p),z=dc.rowChart("#episode-asset-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(A).group(S).valueAccessor(function(t){return t.value?t.value.downloads:0}).ordering(function(t){return-t.value.downloads}).label(function(t){return assetNames[t.key]}).title(function(t){return t.value.downloads}).colors("#69B3FF").on("preRedraw",g).on("renderlet",p),I=dc.rowChart("#episode-client-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(b).group(O).valueAccessor(function(t){return t.value.downloads}).ordering(function(t){return-t.value.downloads}).othersGrouper(function(t){return t}).cap(10).label(function(t){return t.key}).colors("#69B3FF").on("preRedraw",g).on("renderlet",p),X=dc.rowChart("#episode-system-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(_).group(M).valueAccessor(function(t){return t.value.downloads}).ordering(function(t){return-t.value.downloads}).othersGrouper(function(t){return t}).cap(10).label(function(t){return t.key}).colors("#69B3FF").on("preRedraw",g).on("renderlet",p),j=dc.rowChart("#episode-source-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(k).group(F).valueAccessor(function(t){return t.value.downloads}).ordering(function(t){return-t.value.downloads}).label(function(t){return t.key}).colors("#69B3FF").on("preRedraw",g).on("renderlet",p),q=dc.rowChart("#episode-context-chart").margins({top:0,left:40,right:10,bottom:25}).elasticX(!0).dimension(w).group(B).valueAccessor(function(t){return t.value.downloads}).ordering(function(t){return-t.value.downloads}).label(function(t){return t.value.source+"/"+t.key}).colors("#69B3FF").on("preRedraw",g).on("renderlet",p);G.yAxis().ticks([2]),G.xAxis().tickFormat(function(t){return PODLOVE.Analytics.hourFormat(t*n)}),Y.xAxis().tickFormat(function(t){return PODLOVE.Analytics.hourFormat(t*n)}),G.yAxis().tickFormat(PODLOVE.Analytics.formatThousands),Y.yAxis().tickFormat(PODLOVE.Analytics.formatThousands),Y.rightYAxis().tickFormat(PODLOVE.Analytics.formatThousands),U.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),z.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),I.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),X.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),j.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),q.xAxis().tickFormat(PODLOVE.Analytics.formatThousands),[Y,G,U,z,I,X,j,q].forEach(function(t){t.render()});var W=function(t,e){t.brush().extent([e.min/n,Math.min(H,e.max/n)]).event(t.select("g.brush"))};l.min||l.max||(l.min=0,l.max=168,t("#chart-zoom-selection .button:eq(1)").addClass("active")),W(G,l),G.brush().on("brushend",function(){var e=t("#chart-zoom-selection .button").map(function(){return t(this).data("hours")}),r=G.brush().extent();l.min=r[0]*n,l.max=r[1]*n,l.min<0&&(l.max-=l.min,l.min=0,W(G,l));(function(){return-1===t.inArray(Math.round(l.max-l.min),e)})()&&!function(){return 0===l.min&&l.max===G.xUnitCount()*n}()&&t("#chart-zoom-selection .button.active").removeClass("active")}),t("#chart-zoom-selection .button").on("click",function(e){var r=parseInt(t(this).data("hours"),10);e.preventDefault(),t(this).hasClass("disabled")||(t(this).siblings().removeClass("active"),t(this).addClass("active"),0===r?(l.min=0,l.max=G.xUnitCount()*n):l.max=l.min+r,W(G,l))}),e.rendered&&e.rendered instanceof Function&&e.rendered()}function n(n){r?e(n):t.when(t.ajax(ajaxurl+"?action=podlove-analytics-episode-downloads-per-hour&episode="+o),t.ajax(ajaxurl+"?action=podlove-analytics-episode-average-downloads-per-hour")).done(function(t,a){var o=function(t){var e=new Date(1e3*+t.date);return{date:e,downloads:+t.downloads,weekday:e.getDay(),hoursSinceRelease:+t.hours_since_release,asset_id:+t.asset_id,client:t.client?t.client:"Unknown",system:t.system?t.system:"Unknown",source:t.source?t.source:"Unknown",context:t.context?t.context:"Unknown"}};r=d3.csv.parse(t[0],o),i=d3.csv.parse(a[0],function(t){return{hoursSinceRelease:+t.hoursSinceRelease,downloads:+t.downloads}}),e(n)})}var r,i,a=d3.time.format("%Y-%m-%d %H:%M %Z"),o=jQuery("#episode-performance-chart").data("episode"),u=t("#episode-performance-chart").closest(".inside").width(),l={min:null,max:null},s=function(t,e){return t.downloads+=e.downloads,t.weekday=e.weekday,t.asset_id=e.asset_id,t.date=t.date&&t.date<e.date?t.date:e.date,t.client=e.client,t.system=e.system,t.source=e.source,t.context=e.context,t},c=function(t,e){return t.downloads-=e.downloads,t},d=function(){return{downloads:0,weekday:0,asset_id:0,date:0,client:"",system:""}};t("#chart-grouping-selection").on("click","a",function(e){var r=parseInt(t(this).data("hours"),10),i=parseInt(t("#chart-zoom-selection .button.active").data("hours"),10);t(this).siblings().removeClass("active"),t(this).addClass("active"),t("#chart-zoom-selection a.button").each(function(){var e=parseInt(t(this).data("hours"),10);0!==e&&e<r?t(this).addClass("disabled"):t(this).removeClass("disabled")}),n({hours_per_unit:r,rendered:function(){if(0!==i&&(NaN===i||i<r)){t("#chart-zoom-selection a.button").filter(function(){var e=parseInt(t(this).data("hours"),10);return 0===e||e>=r}).first().click()}}}),e.preventDefault()}),t("#chart-grouping-selection a:eq(3)").click(),t("input[name='podlove_analytics_tiles']").each(function(){var e=t(this).attr("checked"),n=t(this).val(),r=t(".chart-wrapper[data-tile-id='"+n+"']");e||r.hide()}).on("click",function(){var e=t(this).attr("checked"),n=t(this).val(),r=t(".chart-wrapper[data-tile-id='"+n+"']");t.ajax({url:ajaxurl,data:{action:"podlove-analytics-settings-tiles-update",tile_id:n,checked:e}}),e?r.show():r.hide()})}),jQuery(document).ready(function(t){function e(){var e=t("#total-chart").closest(".wrap").width(),o=crossfilter(n),u=o.groupAll().reduce(r,i,a),l=u.value().downloads,s=o.dimension(function(t){return d3.time.day(t.date)}),c=o.dimension(function(t){return t.episode_id}),d=c.group().reduce(function(t,e){return t.downloads+=e.downloads,t.episode_id=e.episode_id,t},null,function(){return{downloads:0,episode_id:0}}),f=d.all().reduce(function(t,e){return e.value.downloads>.05*l&&t.push(e),t},[]),h=_.pluck(f,"key"),g=s.group().reduce(function(t,e){return _.contains(h,e.episode_id)?t:r(t,e)},function(t,e){return _.contains(h,e.episode_id)?t:i(t,e)},a),p=[];for(var m in h)p[h[m]]=function(t,e){return t.group().reduce(function(t,n){return n.episode_id==e?r(t,n):t},function(t,n){return n.episode_id==e?i(t,n):t},a)}(s,h[m]);var x=d3.time.format("%Y-%m-%d"),v=dc.barChart("#total-chart").width(e).height(200).dimension(s).group(g,"Other Episodes").x(d3.time.scale().domain([function(t){return new Date((new Date).setDate((new Date).getDate()-t))}(28),new Date])).xUnits(d3.time.days).brushOn(!1).renderTitle(!0).elasticY(!0).yAxisLabel("Downloads").valueAccessor(function(t){return t.value.downloads}).title(function(t){return[x(t.key),"Downloads: "+t.value.downloads].join("\n")}).renderHorizontalGridLines(!0);if(e>650){var y=e-300;jQuery("#total-chart").height("200px"),v.height(200),v.legend(dc.legend().horizontal(!1).x(y).y(10).autoItemWidth(!0)),v.margins().bottom=30,v.margins().right=305}else{var y=e-300;jQuery("#total-chart").height("370px"),v.height(370),v.legend(dc.legend().horizontal(!1).x(30).y(170).autoItemWidth(!0)),v.margins().bottom=230}for(var m in p)v.stack(p[m],podlove_episode_names[m]);v.yAxis().tickFormat(PODLOVE.Analytics.formatThousands),v.xAxis().tickFormat(d3.time.format("%d %b")),e<550?v.xAxis().ticks(d3.time.days,5):e<635?v.xAxis().ticks(d3.time.days,4):e<780?v.xAxis().ticks(d3.time.days,3):v.xAxis().ticks(d3.time.days,2),v.render()}var n,r=(d3.time.format("%Y-%m-%d %H:%M %Z"),function(t,e){return t.downloads+=e.downloads,t.episode_id=e.episode_id,t.date=e.date,t}),i=function(t,e){return t.downloads-=e.downloads,t},a=function(){return{downloads:0,episode_id:0,date:0}};t("#total-chart").length&&function(){n?(e(),t(window).on("resize",e)):t.when(t.ajax(ajaxurl+"?action=podlove-analytics-total-downloads-per-day")).done(function(r){var i=function(t){return{date:new Date(1e3*+t.date),downloads:+t.downloads,episode_id:+t.episode_id}};n=d3.csv.parse(r,i),e(),t(window).on("resize",e)})}()});